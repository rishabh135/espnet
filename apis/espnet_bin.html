<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>core tools &mdash; ESPnet 202205 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="core tools (espnet2)" href="espnet2_bin.html" />
    <link rel="prev" title="espnet2.main_funcs package" href="../_gen/espnet2.main_funcs.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> ESPnet
          </a>
              <div class="version">
                202205
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallelization.html">Using Job scheduling system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">Docker</a></li>
</ul>
<p><span class="caption-text">ESPnet2:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_tutorial.html">ESPnet2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_tutorial.html#instruction-for-run-sh">Instruction for run.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_training_option.html">Change the configuration for training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_task.html">Task class and data input system for training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_distributed.html">Distributed training</a></li>
</ul>
<p><span class="caption-text">Notebook:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebook/asr_cli.html">Speech Recognition (Recipe)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/asr_library.html">Speech Recognition (Library)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_asr_realtime_demo.html">ESPnet2-ASR realtime demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_asr_transfer_learning_demo.html"><strong>Use transfer learning for ASR in ESPnet2</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_asr_transfer_learning_demo.html#Abstract">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_asr_transfer_learning_demo.html#ESPnet-installation-(about-10-minutes-in-total)">ESPnet installation (about 10 minutes in total)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_asr_transfer_learning_demo.html#mini_an4-recipe-as-a-transfer-learning-example">mini_an4 recipe as a transfer learning example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_streaming_asr_demo.html">ESPnet2 real streaming Transformer demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_tts_realtime_demo.html">ESPnet2-TTS realtime demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_tutorial_2021_CMU_11751_18781.html">CMU 11751/18781 2021: ESPnet Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_tutorial_2021_CMU_11751_18781.html#Run-an-inference-example">Run an inference example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_tutorial_2021_CMU_11751_18781.html#Full-installation">Full installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_tutorial_2021_CMU_11751_18781.html#Run-a-recipe-example">Run a recipe example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet_se_demonstration_for_waspaa_2021.html">ESPnet Speech Enhancement Demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet_se_demonstration_for_waspaa_2021.html#Contents">Contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet_se_demonstration_for_waspaa_2021.html#(1)-Tutorials-on-the-Basic-Usage">(1) Tutorials on the Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet_se_demonstration_for_waspaa_2021.html#(2)-Tutorials-on-Contributing-to-ESPNet-SE-Project">(2) Tutorials on Contributing to ESPNet-SE Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/pretrained.html">Pretrained Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/se_demo.html">ESPnet Speech Enhancement Demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/st_demo.html">ESPnet Speech Translation Demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/tts_cli.html">Text-to-Speech (Recipe)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/tts_realtime_demo.html">ESPnet real time E2E-TTS demonstration</a></li>
</ul>
<p><span class="caption-text">Package Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet.optimizer.html">espnet.optimizer package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet.utils.html">espnet.utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet.mt.html">espnet.mt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet.nets.html">espnet.nets package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet.tts.html">espnet.tts package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet.vc.html">espnet.vc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet.st.html">espnet.st package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet.scheduler.html">espnet.scheduler package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet.asr.html">espnet.asr package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet.bin.html">espnet.bin package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet.lm.html">espnet.lm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet.transform.html">espnet.transform package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.fst.html">espnet2.fst package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.schedulers.html">espnet2.schedulers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.samplers.html">espnet2.samplers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.utils.html">espnet2.utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.fileio.html">espnet2.fileio package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.iterators.html">espnet2.iterators package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.mt.html">espnet2.mt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.hubert.html">espnet2.hubert package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.enh.html">espnet2.enh package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.optimizers.html">espnet2.optimizers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.train.html">espnet2.train package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.tts.html">espnet2.tts package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.st.html">espnet2.st package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.text.html">espnet2.text package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.torch_utils.html">espnet2.torch_utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.gan_tts.html">espnet2.gan_tts package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.asr.html">espnet2.asr package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.bin.html">espnet2.bin package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.lm.html">espnet2.lm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.tasks.html">espnet2.tasks package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.diar.html">espnet2.diar package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.layers.html">espnet2.layers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_gen/espnet2.main_funcs.html">espnet2.main_funcs package</a></li>
</ul>
<p><span class="caption-text">Tool Reference:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">core tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#asr-align-py">asr_align.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#asr-enhance-py">asr_enhance.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#asr-recog-py">asr_recog.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#asr-train-py">asr_train.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lm-train-py">lm_train.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mt-train-py">mt_train.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mt-trans-py">mt_trans.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#st-train-py">st_train.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#st-trans-py">st_trans.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tts-decode-py">tts_decode.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tts-train-py">tts_train.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vc-decode-py">vc_decode.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vc-train-py">vc_train.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="espnet2_bin.html">core tools (espnet2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils_py.html">python utility tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils_sh.html">bash utility tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ESPnet</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>core tools</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/apis/espnet_bin.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="core-tools">
<span id="id1"></span><h1>core tools<a class="headerlink" href="#core-tools" title="Permalink to this headline">¶</a></h1>
<p>ESPnet provides several command-line tools for training and evaluating neural networks (NN) under <code class="docutils literal notranslate"><span class="pre">espnet/bin</span></code>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#asr-align-py"><span class="std std-ref">asr_align.py</span></a>: Align text to audio using CTC segmentation.using a pre-trained speech recognition model.</p></li>
<li><p><a class="reference internal" href="#asr-enhance-py"><span class="std std-ref">asr_enhance.py</span></a>: Enhance noisy speech for speech recognition</p></li>
<li><p><a class="reference internal" href="#asr-recog-py"><span class="std std-ref">asr_recog.py</span></a>: Transcribe text from speech using a speech recognition model on one CPU or GPU</p></li>
<li><p><a class="reference internal" href="#asr-train-py"><span class="std std-ref">asr_train.py</span></a>: Train an automatic speech recognition (ASR) model on one CPU, one or multiple GPUs</p></li>
<li><p><a class="reference internal" href="#lm-train-py"><span class="std std-ref">lm_train.py</span></a>: Train a new language model on one CPU or one GPU</p></li>
<li><p><a class="reference internal" href="#mt-train-py"><span class="std std-ref">mt_train.py</span></a>: Train a neural machine translation (NMT) model on one CPU, one or multiple GPUs</p></li>
<li><p><a class="reference internal" href="#mt-trans-py"><span class="std std-ref">mt_trans.py</span></a>: Translate text from speech using a speech translation model on one CPU or GPU</p></li>
<li><p><a class="reference internal" href="#st-train-py"><span class="std std-ref">st_train.py</span></a>: Train a speech translation (ST) model on one CPU, one or multiple GPUs</p></li>
<li><p><a class="reference internal" href="#st-trans-py"><span class="std std-ref">st_trans.py</span></a>: Translate text from speech using a speech translation model on one CPU or GPU</p></li>
<li><p><a class="reference internal" href="#tts-decode-py"><span class="std std-ref">tts_decode.py</span></a>: Synthesize speech from text using a TTS model on one CPU</p></li>
<li><p><a class="reference internal" href="#tts-train-py"><span class="std std-ref">tts_train.py</span></a>: Train a new text-to-speech (TTS) model on one CPU, one or multiple GPUs</p></li>
<li><p><a class="reference internal" href="#vc-decode-py"><span class="std std-ref">vc_decode.py</span></a>: Converting speech using a VC model on one CPU</p></li>
<li><p><a class="reference internal" href="#vc-train-py"><span class="std std-ref">vc_train.py</span></a>: Train a new voice conversion (VC) model on one CPU, one or multiple GPUs</p></li>
</ul>
<section id="asr-align-py">
<span id="id2"></span><h2>asr_align.py<a class="headerlink" href="#asr-align-py" title="Permalink to this headline">¶</a></h2>
<p><p>Align text to audio using CTC segmentation.using a pre-trained speech recognition model.</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">asr_align</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">dtype</span> <span class="p">{</span><span class="n">float16</span><span class="p">,</span><span class="n">float32</span><span class="p">,</span><span class="n">float64</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">pytorch</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">preprocess</span><span class="o">-</span><span class="n">conf</span> <span class="n">PREPROCESS_CONF</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">json</span> <span class="n">DATA_JSON</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">utt</span><span class="o">-</span><span class="n">text</span> <span class="n">UTT_TEXT</span><span class="p">]</span> <span class="o">--</span><span class="n">model</span>
                    <span class="n">MODEL</span> <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">conf</span> <span class="n">MODEL_CONF</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">encs</span> <span class="n">NUM_ENCS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">subsampling</span><span class="o">-</span><span class="n">factor</span> <span class="n">SUBSAMPLING_FACTOR</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">frame</span><span class="o">-</span><span class="n">duration</span> <span class="n">FRAME_DURATION</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">window</span><span class="o">-</span><span class="n">size</span> <span class="n">MIN_WINDOW_SIZE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">window</span><span class="o">-</span><span class="n">size</span> <span class="n">MAX_WINDOW_SIZE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="nb">dict</span><span class="o">-</span><span class="n">blank</span> <span class="n">USE_DICT_BLANK</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="nb">set</span><span class="o">-</span><span class="n">blank</span> <span class="n">SET_BLANK</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">gratis</span><span class="o">-</span><span class="n">blank</span> <span class="n">GRATIS_BLANK</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">replace</span><span class="o">-</span><span class="n">spaces</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">blanks</span> <span class="n">REPLACE_SPACES_WITH_BLANKS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">scoring</span><span class="o">-</span><span class="n">length</span> <span class="n">SCORING_LENGTH</span><span class="p">]</span> <span class="o">--</span><span class="n">output</span> <span class="n">OUTPUT</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>Decoding config file path.</p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs (max. 1 is supported)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--dtype</kbd></dt>
<dd><p>Possible choices: float16, float32, float64</p>
<p>Float precision (only available in –api v2)</p>
<p>Default: “float32”</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: pytorch</p>
<p>Backend library</p>
<p>Default: “pytorch”</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--preprocess-conf</kbd></dt>
<dd><p>The configuration file for the pre-processing</p>
</dd>
<dt><kbd>--data-json</kbd></dt>
<dd><p>Json of recognition data for audio and text</p>
</dd>
<dt><kbd>--utt-text</kbd></dt>
<dd><p>Text separated into utterances</p>
</dd>
<dt><kbd>--model</kbd></dt>
<dd><p>Model file parameters to read</p>
</dd>
<dt><kbd>--model-conf</kbd></dt>
<dd><p>Model config file</p>
</dd>
<dt><kbd>--num-encs</kbd></dt>
<dd><p>Number of encoders in the model.</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--subsampling-factor</kbd></dt>
<dd><p>Subsampling factor. If the encoder sub-samples its input, the number of frames at the CTC layer is reduced by this factor. For example, a BLSTMP with subsampling 1_2_2_1_1 has a subsampling factor of 4.</p>
</dd>
<dt><kbd>--frame-duration</kbd></dt>
<dd><p>Non-overlapping duration of a single frame in milliseconds.</p>
</dd>
<dt><kbd>--min-window-size</kbd></dt>
<dd><p>Minimum window size considered for utterance.</p>
</dd>
<dt><kbd>--max-window-size</kbd></dt>
<dd><p>Maximum window size considered for utterance.</p>
</dd>
<dt><kbd>--use-dict-blank</kbd></dt>
<dd><p>DEPRECATED.</p>
</dd>
<dt><kbd>--set-blank</kbd></dt>
<dd><p>Index of model dictionary for blank token (default: 0).</p>
</dd>
<dt><kbd>--gratis-blank</kbd></dt>
<dd><p>Set the transition cost of the blank token to zero. Audio sections labeled with blank tokens can then be skipped without penalty. Useful if there are unrelated audio segments between utterances.</p>
</dd>
<dt><kbd>--replace-spaces-with-blanks</kbd></dt>
<dd><p>Fill blanks in between words to better model pauses between words. Segments can be misaligned if this option is combined with –gratis-blank. May increase length of ground truth.</p>
</dd>
<dt><kbd>--scoring-length</kbd></dt>
<dd><p>Changes partitioning length L for calculation of the confidence score.</p>
</dd>
<dt><kbd>--output</kbd></dt>
<dd><p>Output segments file</p>
</dd>
</dl>
</section>
</section>
<section id="asr-enhance-py">
<span id="id3"></span><h2>asr_enhance.py<a class="headerlink" href="#asr-enhance-py" title="Permalink to this headline">¶</a></h2>
<p><p>Enhance noisy speech for speech recognition</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">asr_enhance</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config2</span> <span class="n">CONFIG2</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">config3</span> <span class="n">CONFIG3</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">chainer</span><span class="p">,</span><span class="n">pytorch</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">batchsize</span> <span class="n">BATCHSIZE</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">preprocess</span><span class="o">-</span><span class="n">conf</span> <span class="n">PREPROCESS_CONF</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">recog</span><span class="o">-</span><span class="n">json</span> <span class="n">RECOG_JSON</span><span class="p">]</span> <span class="o">--</span><span class="n">model</span> <span class="n">MODEL</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">conf</span> <span class="n">MODEL_CONF</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">enh</span><span class="o">-</span><span class="n">wspecifier</span> <span class="n">ENH_WSPECIFIER</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">enh</span><span class="o">-</span><span class="n">filetype</span> <span class="p">{</span><span class="n">mat</span><span class="p">,</span><span class="n">hdf5</span><span class="p">,</span><span class="n">sound</span><span class="o">.</span><span class="n">hdf5</span><span class="p">,</span><span class="n">sound</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">fs</span> <span class="n">FS</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">keep</span><span class="o">-</span><span class="n">length</span> <span class="n">KEEP_LENGTH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">image</span><span class="o">-</span><span class="nb">dir</span> <span class="n">IMAGE_DIR</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">images</span> <span class="n">NUM_IMAGES</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">apply</span><span class="o">-</span><span class="n">istft</span> <span class="n">APPLY_ISTFT</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">istft</span><span class="o">-</span><span class="n">win</span><span class="o">-</span><span class="n">length</span> <span class="n">ISTFT_WIN_LENGTH</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">istft</span><span class="o">-</span><span class="n">n</span><span class="o">-</span><span class="n">shift</span> <span class="n">ISTFT_N_SHIFT</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">istft</span><span class="o">-</span><span class="n">window</span> <span class="n">ISTFT_WINDOW</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>config file path</p>
</dd>
<dt><kbd>--config2</kbd></dt>
<dd><p>second config file path that overwrites the settings in <cite>–config</cite>.</p>
</dd>
<dt><kbd>--config3</kbd></dt>
<dd><p>third config file path that overwrites the settings in <cite>–config</cite> and <cite>–config2</cite>.</p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: chainer, pytorch</p>
<p>Backend library</p>
<p>Default: “chainer”</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>Random seed</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--batchsize</kbd></dt>
<dd><p>Batch size for beam search (0: means no batch processing)</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--preprocess-conf</kbd></dt>
<dd><p>The configuration file for the pre-processing</p>
</dd>
<dt><kbd>--recog-json</kbd></dt>
<dd><p>Filename of recognition data (json)</p>
</dd>
<dt><kbd>--model</kbd></dt>
<dd><p>Model file parameters to read</p>
</dd>
<dt><kbd>--model-conf</kbd></dt>
<dd><p>Model config file</p>
</dd>
<dt><kbd>--enh-wspecifier</kbd></dt>
<dd><p>Specify the output way for enhanced speech.e.g. ark,scp:outdir,wav.scp</p>
</dd>
<dt><kbd>--enh-filetype</kbd></dt>
<dd><p>Possible choices: mat, hdf5, sound.hdf5, sound</p>
<p>Specify the file format for enhanced speech. “mat” is the matrix format in kaldi</p>
<p>Default: “sound”</p>
</dd>
<dt><kbd>--fs</kbd></dt>
<dd><p>The sample frequency</p>
<p>Default: 16000</p>
</dd>
<dt><kbd>--keep-length</kbd></dt>
<dd><p>Adjust the output length to match with the input for enhanced speech</p>
<p>Default: True</p>
</dd>
<dt><kbd>--image-dir</kbd></dt>
<dd><p>The directory saving the images.</p>
</dd>
<dt><kbd>--num-images</kbd></dt>
<dd><p>The number of images files to be saved. If negative, all samples are to be saved.</p>
<p>Default: 20</p>
</dd>
<dt><kbd>--apply-istft</kbd></dt>
<dd><p>Apply istft to the output from the network</p>
<p>Default: True</p>
</dd>
<dt><kbd>--istft-win-length</kbd></dt>
<dd><p>The window length for istft. This option is ignored if stft is found in the preprocess-conf</p>
<p>Default: 512</p>
</dd>
<dt><kbd>--istft-n-shift</kbd></dt>
<dd><p>The window type for istft. This option is ignored if stft is found in the preprocess-conf</p>
<p>Default: 256</p>
</dd>
<dt><kbd>--istft-window</kbd></dt>
<dd><p>The window type for istft. This option is ignored if stft is found in the preprocess-conf</p>
<p>Default: “hann”</p>
</dd>
</dl>
</section>
</section>
<section id="asr-recog-py">
<span id="id4"></span><h2>asr_recog.py<a class="headerlink" href="#asr-recog-py" title="Permalink to this headline">¶</a></h2>
<p><p>Transcribe text from speech using a speech recognition model on one CPU or GPU</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">asr_recog</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config2</span> <span class="n">CONFIG2</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">config3</span> <span class="n">CONFIG3</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">dtype</span> <span class="p">{</span><span class="n">float16</span><span class="p">,</span><span class="n">float32</span><span class="p">,</span><span class="n">float64</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">chainer</span><span class="p">,</span><span class="n">pytorch</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">batchsize</span> <span class="n">BATCHSIZE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">preprocess</span><span class="o">-</span><span class="n">conf</span> <span class="n">PREPROCESS_CONF</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">api</span> <span class="p">{</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">recog</span><span class="o">-</span><span class="n">json</span> <span class="n">RECOG_JSON</span><span class="p">]</span> <span class="o">--</span><span class="n">result</span><span class="o">-</span><span class="n">label</span> <span class="n">RESULT_LABEL</span>
                    <span class="o">--</span><span class="n">model</span> <span class="n">MODEL</span> <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">conf</span> <span class="n">MODEL_CONF</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">spkrs</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">encs</span> <span class="n">NUM_ENCS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">nbest</span> <span class="n">NBEST</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">beam</span><span class="o">-</span><span class="n">size</span> <span class="n">BEAM_SIZE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">penalty</span> <span class="n">PENALTY</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">maxlenratio</span> <span class="n">MAXLENRATIO</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">minlenratio</span> <span class="n">MINLENRATIO</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">ctc</span><span class="o">-</span><span class="n">weight</span> <span class="n">CTC_WEIGHT</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">weights</span><span class="o">-</span><span class="n">ctc</span><span class="o">-</span><span class="n">dec</span> <span class="n">WEIGHTS_CTC_DEC</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">ctc</span><span class="o">-</span><span class="n">window</span><span class="o">-</span><span class="n">margin</span> <span class="n">CTC_WINDOW_MARGIN</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">search</span><span class="o">-</span><span class="nb">type</span> <span class="p">{</span><span class="n">default</span><span class="p">,</span><span class="n">nsc</span><span class="p">,</span><span class="n">tsd</span><span class="p">,</span><span class="n">alsd</span><span class="p">,</span><span class="n">maes</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">nstep</span> <span class="n">NSTEP</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">prefix</span><span class="o">-</span><span class="n">alpha</span> <span class="n">PREFIX_ALPHA</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">sym</span><span class="o">-</span><span class="n">exp</span> <span class="n">MAX_SYM_EXP</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">u</span><span class="o">-</span><span class="nb">max</span> <span class="n">U_MAX</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">expansion</span><span class="o">-</span><span class="n">gamma</span> <span class="n">EXPANSION_GAMMA</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">expansion</span><span class="o">-</span><span class="n">beta</span> <span class="n">EXPANSION_BETA</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">score</span><span class="o">-</span><span class="n">norm</span> <span class="p">[</span><span class="n">SCORE_NORM</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">softmax</span><span class="o">-</span><span class="n">temperature</span> <span class="n">SOFTMAX_TEMPERATURE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">rnnlm</span> <span class="n">RNNLM</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">rnnlm</span><span class="o">-</span><span class="n">conf</span> <span class="n">RNNLM_CONF</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">word</span><span class="o">-</span><span class="n">rnnlm</span> <span class="n">WORD_RNNLM</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">word</span><span class="o">-</span><span class="n">rnnlm</span><span class="o">-</span><span class="n">conf</span> <span class="n">WORD_RNNLM_CONF</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">word</span><span class="o">-</span><span class="nb">dict</span> <span class="n">WORD_DICT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lm</span><span class="o">-</span><span class="n">weight</span> <span class="n">LM_WEIGHT</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">ngram</span><span class="o">-</span><span class="n">model</span> <span class="n">NGRAM_MODEL</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngram</span><span class="o">-</span><span class="n">weight</span> <span class="n">NGRAM_WEIGHT</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">ngram</span><span class="o">-</span><span class="n">scorer</span> <span class="p">{</span><span class="n">full</span><span class="p">,</span><span class="n">part</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">streaming</span><span class="o">-</span><span class="n">mode</span> <span class="p">{</span><span class="n">window</span><span class="p">,</span><span class="n">segment</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">streaming</span><span class="o">-</span><span class="n">window</span> <span class="n">STREAMING_WINDOW</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">streaming</span><span class="o">-</span><span class="nb">min</span><span class="o">-</span><span class="n">blank</span><span class="o">-</span><span class="n">dur</span> <span class="n">STREAMING_MIN_BLANK_DUR</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">streaming</span><span class="o">-</span><span class="n">onset</span><span class="o">-</span><span class="n">margin</span> <span class="n">STREAMING_ONSET_MARGIN</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">streaming</span><span class="o">-</span><span class="n">offset</span><span class="o">-</span><span class="n">margin</span> <span class="n">STREAMING_OFFSET_MARGIN</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">maskctc</span><span class="o">-</span><span class="n">n</span><span class="o">-</span><span class="n">iterations</span> <span class="n">MASKCTC_N_ITERATIONS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">maskctc</span><span class="o">-</span><span class="n">probability</span><span class="o">-</span><span class="n">threshold</span> <span class="n">MASKCTC_PROBABILITY_THRESHOLD</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">quantize</span><span class="o">-</span><span class="n">config</span> <span class="p">[</span><span class="n">QUANTIZE_CONFIG</span> <span class="p">[</span><span class="n">QUANTIZE_CONFIG</span> <span class="o">...</span><span class="p">]]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">quantize</span><span class="o">-</span><span class="n">dtype</span> <span class="p">{</span><span class="n">float16</span><span class="p">,</span><span class="n">qint8</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">quantize</span><span class="o">-</span><span class="n">asr</span><span class="o">-</span><span class="n">model</span> <span class="n">QUANTIZE_ASR_MODEL</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">quantize</span><span class="o">-</span><span class="n">lm</span><span class="o">-</span><span class="n">model</span> <span class="n">QUANTIZE_LM_MODEL</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>Config file path</p>
</dd>
<dt><kbd>--config2</kbd></dt>
<dd><p>Second config file path that overwrites the settings in <cite>–config</cite></p>
</dd>
<dt><kbd>--config3</kbd></dt>
<dd><p>Third config file path that overwrites the settings in <cite>–config</cite> and <cite>–config2</cite></p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--dtype</kbd></dt>
<dd><p>Possible choices: float16, float32, float64</p>
<p>Float precision (only available in –api v2)</p>
<p>Default: “float32”</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: chainer, pytorch</p>
<p>Backend library</p>
<p>Default: “chainer”</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>Random seed</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--batchsize</kbd></dt>
<dd><p>Batch size for beam search (0: means no batch processing)</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--preprocess-conf</kbd></dt>
<dd><p>The configuration file for the pre-processing</p>
</dd>
<dt><kbd>--api</kbd></dt>
<dd><p>Possible choices: v1, v2</p>
<p>Beam search APIs v1: Default API. It only supports the ASRInterface.recognize method and DefaultRNNLM. v2: Experimental API. It supports any models that implements ScorerInterface.</p>
<p>Default: “v1”</p>
</dd>
<dt><kbd>--recog-json</kbd></dt>
<dd><p>Filename of recognition data (json)</p>
</dd>
<dt><kbd>--result-label</kbd></dt>
<dd><p>Filename of result label data (json)</p>
</dd>
<dt><kbd>--model</kbd></dt>
<dd><p>Model file parameters to read</p>
</dd>
<dt><kbd>--model-conf</kbd></dt>
<dd><p>Model config file</p>
</dd>
<dt><kbd>--num-spkrs</kbd></dt>
<dd><p>Possible choices: 1, 2</p>
<p>Number of speakers in the speech</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--num-encs</kbd></dt>
<dd><p>Number of encoders in the model.</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--nbest</kbd></dt>
<dd><p>Output N-best hypotheses</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--beam-size</kbd></dt>
<dd><p>Beam size</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--penalty</kbd></dt>
<dd><p>Incertion penalty</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--maxlenratio</kbd></dt>
<dd><dl class="simple">
<dt>Input length ratio to obtain max output length.</dt><dd><p>If maxlenratio=0.0 (default), it uses a end-detect function
to automatically find maximum hypothesis lengths.
If maxlenratio&lt;0.0, its absolute value is interpreted
as a constant max output length</p>
</dd>
</dl>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--minlenratio</kbd></dt>
<dd><p>Input length ratio to obtain min output length</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--ctc-weight</kbd></dt>
<dd><p>CTC weight in joint decoding</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--weights-ctc-dec</kbd></dt>
<dd><p>ctc weight assigned to each encoder during decoding.[in multi-encoder mode only]</p>
</dd>
<dt><kbd>--ctc-window-margin</kbd></dt>
<dd><dl class="simple">
<dt>Use CTC window with margin parameter to accelerate</dt><dd><p>CTC/attention decoding especially on GPU. Smaller magin
makes decoding faster, but may increase search errors.
If margin=0 (default), this function is disabled</p>
</dd>
</dl>
<p>Default: 0</p>
</dd>
<dt><kbd>--search-type</kbd></dt>
<dd><p>Possible choices: default, nsc, tsd, alsd, maes</p>
<dl class="simple">
<dt>Type of beam search implementation to use during inference.</dt><dd><p>Can be either: default beam search (“default”),
N-Step Constrained beam search (“nsc”), Time-Synchronous Decoding (“tsd”),
Alignment-Length Synchronous Decoding (“alsd”) or
modified Adaptive Expansion Search (“maes”).</p>
</dd>
</dl>
<p>Default: “default”</p>
</dd>
<dt><kbd>--nstep</kbd></dt>
<dd><dl class="simple">
<dt>Number of expansion steps allowed in NSC beam search or mAES</dt><dd><p>(nstep &gt; 0 for NSC and nstep &gt; 1 for mAES).</p>
</dd>
</dl>
<p>Default: 1</p>
</dd>
<dt><kbd>--prefix-alpha</kbd></dt>
<dd><p>Length prefix difference allowed in NSC beam search or mAES.</p>
<p>Default: 2</p>
</dd>
<dt><kbd>--max-sym-exp</kbd></dt>
<dd><p>Number of symbol expansions allowed in TSD.</p>
<p>Default: 2</p>
</dd>
<dt><kbd>--u-max</kbd></dt>
<dd><p>Length prefix difference allowed in ALSD.</p>
<p>Default: 400</p>
</dd>
<dt><kbd>--expansion-gamma</kbd></dt>
<dd><p>Allowed logp difference for prune-by-value method in mAES.</p>
<p>Default: 2.3</p>
</dd>
<dt><kbd>--expansion-beta</kbd></dt>
<dd><dl class="simple">
<dt>Number of additional candidates for expanded hypotheses</dt><dd><p>selection in mAES.</p>
</dd>
</dl>
<p>Default: 2</p>
</dd>
<dt><kbd>--score-norm</kbd></dt>
<dd><p>Normalize final hypotheses’ score by length</p>
<p>Default: True</p>
</dd>
<dt><kbd>--softmax-temperature</kbd></dt>
<dd><p>Penalization term for softmax function.</p>
<p>Default: 1.0</p>
</dd>
<dt><kbd>--rnnlm</kbd></dt>
<dd><p>RNNLM model file to read</p>
</dd>
<dt><kbd>--rnnlm-conf</kbd></dt>
<dd><p>RNNLM model config file to read</p>
</dd>
<dt><kbd>--word-rnnlm</kbd></dt>
<dd><p>Word RNNLM model file to read</p>
</dd>
<dt><kbd>--word-rnnlm-conf</kbd></dt>
<dd><p>Word RNNLM model config file to read</p>
</dd>
<dt><kbd>--word-dict</kbd></dt>
<dd><p>Word list to read</p>
</dd>
<dt><kbd>--lm-weight</kbd></dt>
<dd><p>RNNLM weight</p>
<p>Default: 0.1</p>
</dd>
<dt><kbd>--ngram-model</kbd></dt>
<dd><p>ngram model file to read</p>
</dd>
<dt><kbd>--ngram-weight</kbd></dt>
<dd><p>ngram weight</p>
<p>Default: 0.1</p>
</dd>
<dt><kbd>--ngram-scorer</kbd></dt>
<dd><p>Possible choices: full, part</p>
<dl class="simple">
<dt>if the ngram is set as a part scorer, similar with CTC scorer,</dt><dd><p>ngram scorer only scores topK hypethesis.
if the ngram is set as full scorer, ngram scorer scores all hypthesis
the decoding speed of part scorer is musch faster than full one</p>
</dd>
</dl>
<p>Default: “part”</p>
</dd>
<dt><kbd>--streaming-mode</kbd></dt>
<dd><p>Possible choices: window, segment</p>
<dl class="simple">
<dt>Use streaming recognizer for inference.</dt><dd><p><cite>–batchsize</cite> must be set to 0 to enable this mode</p>
</dd>
</dl>
</dd>
<dt><kbd>--streaming-window</kbd></dt>
<dd><p>Window size</p>
<p>Default: 10</p>
</dd>
<dt><kbd>--streaming-min-blank-dur</kbd></dt>
<dd><p>Minimum blank duration threshold</p>
<p>Default: 10</p>
</dd>
<dt><kbd>--streaming-onset-margin</kbd></dt>
<dd><p>Onset margin</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--streaming-offset-margin</kbd></dt>
<dd><p>Offset margin</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--maskctc-n-iterations</kbd></dt>
<dd><p>Number of decoding iterations.For Mask CTC, set 0 to predict 1 mask/iter.</p>
<p>Default: 10</p>
</dd>
<dt><kbd>--maskctc-probability-threshold</kbd></dt>
<dd><p>Threshold probability for CTC output</p>
<p>Default: 0.999</p>
</dd>
<dt><kbd>--quantize-config</kbd></dt>
<dd><dl class="simple">
<dt>Config for dynamic quantization provided as a list of modules,</dt><dd><p>separated by a comma. E.g.: –quantize-config=[Linear,LSTM,GRU].
Each specified module should be an attribute of ‘torch.nn’, e.g.:
torch.nn.Linear, torch.nn.LSTM, torch.nn.GRU, …</p>
</dd>
</dl>
</dd>
<dt><kbd>--quantize-dtype</kbd></dt>
<dd><p>Possible choices: float16, qint8</p>
<p>Dtype for dynamic quantization.</p>
<p>Default: “qint8”</p>
</dd>
<dt><kbd>--quantize-asr-model</kbd></dt>
<dd><p>Apply dynamic quantization to ASR model.</p>
<p>Default: False</p>
</dd>
<dt><kbd>--quantize-lm-model</kbd></dt>
<dd><p>Apply dynamic quantization to LM.</p>
<p>Default: False</p>
</dd>
</dl>
</section>
</section>
<section id="asr-train-py">
<span id="id5"></span><h2>asr_train.py<a class="headerlink" href="#asr-train-py" title="Permalink to this headline">¶</a></h2>
<p><p>Train an automatic speech recognition (ASR) model on one CPU, one or multiple GPUs</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">asr_train</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config2</span> <span class="n">CONFIG2</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">config3</span> <span class="n">CONFIG3</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">train</span><span class="o">-</span><span class="n">dtype</span> <span class="p">{</span><span class="n">float16</span><span class="p">,</span><span class="n">float32</span><span class="p">,</span><span class="n">float64</span><span class="p">,</span><span class="n">O0</span><span class="p">,</span><span class="n">O1</span><span class="p">,</span><span class="n">O2</span><span class="p">,</span><span class="n">O3</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">chainer</span><span class="p">,</span><span class="n">pytorch</span><span class="p">}]</span> <span class="o">--</span><span class="n">outdir</span> <span class="n">OUTDIR</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span> <span class="o">--</span><span class="nb">dict</span> <span class="n">DICT</span> <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">debugdir</span> <span class="n">DEBUGDIR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">resume</span> <span class="p">[</span><span class="n">RESUME</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">minibatches</span> <span class="n">MINIBATCHES</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">tensorboard</span><span class="o">-</span><span class="nb">dir</span> <span class="p">[</span><span class="n">TENSORBOARD_DIR</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">report</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">iters</span> <span class="n">REPORT_INTERVAL_ITERS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">iters</span> <span class="n">SAVE_INTERVAL_ITERS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">train</span><span class="o">-</span><span class="n">json</span> <span class="n">TRAIN_JSON</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">valid</span><span class="o">-</span><span class="n">json</span> <span class="n">VALID_JSON</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">module</span> <span class="n">MODEL_MODULE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">encs</span> <span class="n">NUM_ENCS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">ctc_type</span> <span class="p">{</span><span class="n">builtin</span><span class="p">,</span><span class="n">warpctc</span><span class="p">,</span><span class="n">gtnctc</span><span class="p">,</span><span class="n">cudnnctc</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">mtlalpha</span> <span class="n">MTLALPHA</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lsm</span><span class="o">-</span><span class="n">weight</span> <span class="n">LSM_WEIGHT</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">report</span><span class="o">-</span><span class="n">cer</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">report</span><span class="o">-</span><span class="n">wer</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">nbest</span> <span class="n">NBEST</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">beam</span><span class="o">-</span><span class="n">size</span> <span class="n">BEAM_SIZE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">penalty</span> <span class="n">PENALTY</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">maxlenratio</span> <span class="n">MAXLENRATIO</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">minlenratio</span> <span class="n">MINLENRATIO</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">ctc</span><span class="o">-</span><span class="n">weight</span> <span class="n">CTC_WEIGHT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">rnnlm</span> <span class="n">RNNLM</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">rnnlm</span><span class="o">-</span><span class="n">conf</span> <span class="n">RNNLM_CONF</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lm</span><span class="o">-</span><span class="n">weight</span> <span class="n">LM_WEIGHT</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">sym</span><span class="o">-</span><span class="n">space</span> <span class="n">SYM_SPACE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">sym</span><span class="o">-</span><span class="n">blank</span> <span class="n">SYM_BLANK</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">sortagrad</span> <span class="p">[</span><span class="n">SORTAGRAD</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">count</span> <span class="p">{</span><span class="n">auto</span><span class="p">,</span><span class="n">seq</span><span class="p">,</span><span class="nb">bin</span><span class="p">,</span><span class="n">frame</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">size</span> <span class="n">BATCH_SIZE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">bins</span> <span class="n">BATCH_BINS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="ow">in</span> <span class="n">BATCH_FRAMES_IN</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="n">out</span> <span class="n">BATCH_FRAMES_OUT</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="n">inout</span> <span class="n">BATCH_FRAMES_INOUT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">maxlen</span><span class="o">-</span><span class="ow">in</span> <span class="n">ML</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">maxlen</span><span class="o">-</span><span class="n">out</span> <span class="n">ML</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">n</span><span class="o">-</span><span class="nb">iter</span><span class="o">-</span><span class="n">processes</span> <span class="n">N_ITER_PROCESSES</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">preprocess</span><span class="o">-</span><span class="n">conf</span> <span class="p">[</span><span class="n">PREPROCESS_CONF</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">opt</span> <span class="p">{</span><span class="n">adadelta</span><span class="p">,</span><span class="n">adam</span><span class="p">,</span><span class="n">noam</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">accum</span><span class="o">-</span><span class="n">grad</span> <span class="n">ACCUM_GRAD</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">eps</span> <span class="n">EPS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">eps</span><span class="o">-</span><span class="n">decay</span> <span class="n">EPS_DECAY</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">weight</span><span class="o">-</span><span class="n">decay</span> <span class="n">WEIGHT_DECAY</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">criterion</span> <span class="p">{</span><span class="n">loss</span><span class="p">,</span><span class="n">loss_eps_decay_only</span><span class="p">,</span><span class="n">acc</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">threshold</span> <span class="n">THRESHOLD</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">epochs</span> <span class="n">EPOCHS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">early</span><span class="o">-</span><span class="n">stop</span><span class="o">-</span><span class="n">criterion</span> <span class="p">[</span><span class="n">EARLY_STOP_CRITERION</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">patience</span> <span class="p">[</span><span class="n">PATIENCE</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">grad</span><span class="o">-</span><span class="n">clip</span> <span class="n">GRAD_CLIP</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">save</span><span class="o">-</span><span class="n">attention</span> <span class="n">NUM_SAVE_ATTENTION</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">save</span><span class="o">-</span><span class="n">ctc</span> <span class="n">NUM_SAVE_CTC</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">grad</span><span class="o">-</span><span class="n">noise</span> <span class="n">GRAD_NOISE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">spkrs</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">context</span><span class="o">-</span><span class="n">residual</span> <span class="p">[</span><span class="n">CONTEXT_RESIDUAL</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">enc</span><span class="o">-</span><span class="n">init</span> <span class="n">ENC_INIT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">enc</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">mods</span> <span class="n">ENC_INIT_MODS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">dec</span><span class="o">-</span><span class="n">init</span> <span class="n">DEC_INIT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">dec</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">mods</span> <span class="n">DEC_INIT_MODS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">freeze</span><span class="o">-</span><span class="n">mods</span> <span class="n">FREEZE_MODS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">frontend</span> <span class="n">USE_FRONTEND</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">wpe</span> <span class="n">USE_WPE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">wtype</span> <span class="p">{</span><span class="n">lstm</span><span class="p">,</span><span class="n">blstm</span><span class="p">,</span><span class="n">lstmp</span><span class="p">,</span><span class="n">blstmp</span><span class="p">,</span><span class="n">vgglstmp</span><span class="p">,</span><span class="n">vggblstmp</span><span class="p">,</span><span class="n">vgglstm</span><span class="p">,</span><span class="n">vggblstm</span><span class="p">,</span><span class="n">gru</span><span class="p">,</span><span class="n">bgru</span><span class="p">,</span><span class="n">grup</span><span class="p">,</span><span class="n">bgrup</span><span class="p">,</span><span class="n">vgggrup</span><span class="p">,</span><span class="n">vggbgrup</span><span class="p">,</span><span class="n">vgggru</span><span class="p">,</span><span class="n">vggbgru</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">wlayers</span> <span class="n">WLAYERS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">wunits</span> <span class="n">WUNITS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">wprojs</span> <span class="n">WPROJS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">wdropout</span><span class="o">-</span><span class="n">rate</span> <span class="n">WDROPOUT_RATE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">wpe</span><span class="o">-</span><span class="n">taps</span> <span class="n">WPE_TAPS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">wpe</span><span class="o">-</span><span class="n">delay</span> <span class="n">WPE_DELAY</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">dnn</span><span class="o">-</span><span class="n">mask</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">wpe</span> <span class="n">USE_DNN_MASK_FOR_WPE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">beamformer</span> <span class="n">USE_BEAMFORMER</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">btype</span> <span class="p">{</span><span class="n">lstm</span><span class="p">,</span><span class="n">blstm</span><span class="p">,</span><span class="n">lstmp</span><span class="p">,</span><span class="n">blstmp</span><span class="p">,</span><span class="n">vgglstmp</span><span class="p">,</span><span class="n">vggblstmp</span><span class="p">,</span><span class="n">vgglstm</span><span class="p">,</span><span class="n">vggblstm</span><span class="p">,</span><span class="n">gru</span><span class="p">,</span><span class="n">bgru</span><span class="p">,</span><span class="n">grup</span><span class="p">,</span><span class="n">bgrup</span><span class="p">,</span><span class="n">vgggrup</span><span class="p">,</span><span class="n">vggbgrup</span><span class="p">,</span><span class="n">vgggru</span><span class="p">,</span><span class="n">vggbgru</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">blayers</span> <span class="n">BLAYERS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">bunits</span> <span class="n">BUNITS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">bprojs</span> <span class="n">BPROJS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">badim</span> <span class="n">BADIM</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">bnmask</span> <span class="n">BNMASK</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">ref</span><span class="o">-</span><span class="n">channel</span> <span class="n">REF_CHANNEL</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">bdropout</span><span class="o">-</span><span class="n">rate</span> <span class="n">BDROPOUT_RATE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">stats</span><span class="o">-</span><span class="n">file</span> <span class="n">STATS_FILE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">apply</span><span class="o">-</span><span class="n">uttmvn</span> <span class="n">APPLY_UTTMVN</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">uttmvn</span><span class="o">-</span><span class="n">norm</span><span class="o">-</span><span class="n">means</span> <span class="n">UTTMVN_NORM_MEANS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">uttmvn</span><span class="o">-</span><span class="n">norm</span><span class="o">-</span><span class="nb">vars</span> <span class="n">UTTMVN_NORM_VARS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">fbank</span><span class="o">-</span><span class="n">fs</span> <span class="n">FBANK_FS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">n</span><span class="o">-</span><span class="n">mels</span> <span class="n">N_MELS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">fbank</span><span class="o">-</span><span class="n">fmin</span> <span class="n">FBANK_FMIN</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">fbank</span><span class="o">-</span><span class="n">fmax</span> <span class="n">FBANK_FMAX</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>config file path</p>
</dd>
<dt><kbd>--config2</kbd></dt>
<dd><p>second config file path that overwrites the settings in <cite>–config</cite>.</p>
</dd>
<dt><kbd>--config3</kbd></dt>
<dd><p>third config file path that overwrites the settings in <cite>–config</cite> and <cite>–config2</cite>.</p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs. If not given, use all visible devices</p>
</dd>
<dt><kbd>--train-dtype</kbd></dt>
<dd><p>Possible choices: float16, float32, float64, O0, O1, O2, O3</p>
<p>Data type for training (only pytorch backend). O0,O1,.. flags require apex. See <a class="reference external" href="https://nvidia.github.io/apex/amp.html#opt-levels">https://nvidia.github.io/apex/amp.html#opt-levels</a></p>
<p>Default: “float32”</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: chainer, pytorch</p>
<p>Backend library</p>
<p>Default: “chainer”</p>
</dd>
<dt><kbd>--outdir</kbd></dt>
<dd><p>Output directory</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--dict</kbd></dt>
<dd><p>Dictionary</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>Random seed</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--debugdir</kbd></dt>
<dd><p>Output directory for debugging</p>
</dd>
<dt><kbd>--resume, -r</kbd></dt>
<dd><p>Resume the training from snapshot</p>
<p>Default: “”</p>
</dd>
<dt><kbd>--minibatches, -N</kbd></dt>
<dd><p>Process only N minibatches (for debug)</p>
<p>Default: -1</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--tensorboard-dir</kbd></dt>
<dd><p>Tensorboard log dir path</p>
</dd>
<dt><kbd>--report-interval-iters</kbd></dt>
<dd><p>Report interval iterations</p>
<p>Default: 100</p>
</dd>
<dt><kbd>--save-interval-iters</kbd></dt>
<dd><p>Save snapshot interval iterations</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--train-json</kbd></dt>
<dd><p>Filename of train label data (json)</p>
</dd>
<dt><kbd>--valid-json</kbd></dt>
<dd><p>Filename of validation label data (json)</p>
</dd>
<dt><kbd>--model-module</kbd></dt>
<dd><p>model defined module (default: espnet.nets.xxx_backend.e2e_asr:E2E)</p>
</dd>
<dt><kbd>--num-encs</kbd></dt>
<dd><p>Number of encoders in the model.</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--ctc_type</kbd></dt>
<dd><p>Possible choices: builtin, warpctc, gtnctc, cudnnctc</p>
<p>Type of CTC implementation to calculate loss.</p>
<p>Default: “warpctc”</p>
</dd>
<dt><kbd>--mtlalpha</kbd></dt>
<dd><p>Multitask learning coefficient, alpha: alpha*ctc_loss + (1-alpha)*att_loss</p>
<p>Default: 0.5</p>
</dd>
<dt><kbd>--lsm-weight</kbd></dt>
<dd><p>Label smoothing weight</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--report-cer</kbd></dt>
<dd><p>Compute CER on development set</p>
<p>Default: False</p>
</dd>
<dt><kbd>--report-wer</kbd></dt>
<dd><p>Compute WER on development set</p>
<p>Default: False</p>
</dd>
<dt><kbd>--nbest</kbd></dt>
<dd><p>Output N-best hypotheses</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--beam-size</kbd></dt>
<dd><p>Beam size</p>
<p>Default: 4</p>
</dd>
<dt><kbd>--penalty</kbd></dt>
<dd><p>Incertion penalty</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--maxlenratio</kbd></dt>
<dd><dl class="simple">
<dt>Input length ratio to obtain max output length.</dt><dd><p>If maxlenratio=0.0 (default), it uses a end-detect function
to automatically find maximum hypothesis lengths</p>
</dd>
</dl>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--minlenratio</kbd></dt>
<dd><p>Input length ratio to obtain min output length</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--ctc-weight</kbd></dt>
<dd><p>CTC weight in joint decoding</p>
<p>Default: 0.3</p>
</dd>
<dt><kbd>--rnnlm</kbd></dt>
<dd><p>RNNLM model file to read</p>
</dd>
<dt><kbd>--rnnlm-conf</kbd></dt>
<dd><p>RNNLM model config file to read</p>
</dd>
<dt><kbd>--lm-weight</kbd></dt>
<dd><p>RNNLM weight.</p>
<p>Default: 0.1</p>
</dd>
<dt><kbd>--sym-space</kbd></dt>
<dd><p>Space symbol</p>
<p>Default: “&lt;space&gt;”</p>
</dd>
<dt><kbd>--sym-blank</kbd></dt>
<dd><p>Blank symbol</p>
<p>Default: “&lt;blank&gt;”</p>
</dd>
<dt><kbd>--sortagrad</kbd></dt>
<dd><p>How many epochs to use sortagrad for. 0 = deactivated, -1 = all epochs</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-count</kbd></dt>
<dd><p>Possible choices: auto, seq, bin, frame</p>
<p>How to count batch_size. The default (auto) will find how to count by args.</p>
<p>Default: “auto”</p>
</dd>
<dt><kbd>--batch-size, --batch-seqs, -b</kbd></dt>
<dd><p>Maximum seqs in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-bins</kbd></dt>
<dd><p>Maximum bins in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-in</kbd></dt>
<dd><p>Maximum input frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-out</kbd></dt>
<dd><p>Maximum output frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-inout</kbd></dt>
<dd><p>Maximum input+output frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--maxlen-in, --batch-seq-maxlen-in</kbd></dt>
<dd><p>When –batch-count=seq, batch size is reduced if the input sequence length &gt; ML.</p>
<p>Default: 800</p>
</dd>
<dt><kbd>--maxlen-out, --batch-seq-maxlen-out</kbd></dt>
<dd><p>When –batch-count=seq, batch size is reduced if the output sequence length &gt; ML</p>
<p>Default: 150</p>
</dd>
<dt><kbd>--n-iter-processes</kbd></dt>
<dd><p>Number of processes of iterator</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--preprocess-conf</kbd></dt>
<dd><p>The configuration file for the pre-processing</p>
</dd>
<dt><kbd>--opt</kbd></dt>
<dd><p>Possible choices: adadelta, adam, noam</p>
<p>Optimizer</p>
<p>Default: “adadelta”</p>
</dd>
<dt><kbd>--accum-grad</kbd></dt>
<dd><p>Number of gradient accumuration</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--eps</kbd></dt>
<dd><p>Epsilon constant for optimizer</p>
<p>Default: 1e-08</p>
</dd>
<dt><kbd>--eps-decay</kbd></dt>
<dd><p>Decaying ratio of epsilon</p>
<p>Default: 0.01</p>
</dd>
<dt><kbd>--weight-decay</kbd></dt>
<dd><p>Weight decay ratio</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--criterion</kbd></dt>
<dd><p>Possible choices: loss, loss_eps_decay_only, acc</p>
<p>Criterion to perform epsilon decay</p>
<p>Default: “acc”</p>
</dd>
<dt><kbd>--threshold</kbd></dt>
<dd><p>Threshold to stop iteration</p>
<p>Default: 0.0001</p>
</dd>
<dt><kbd>--epochs, -e</kbd></dt>
<dd><p>Maximum number of epochs</p>
<p>Default: 30</p>
</dd>
<dt><kbd>--early-stop-criterion</kbd></dt>
<dd><p>Value to monitor to trigger an early stopping of the training</p>
<p>Default: “validation/main/acc”</p>
</dd>
<dt><kbd>--patience</kbd></dt>
<dd><p>Number of epochs to wait without improvement before stopping the training</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--grad-clip</kbd></dt>
<dd><p>Gradient norm threshold to clip</p>
<p>Default: 5</p>
</dd>
<dt><kbd>--num-save-attention</kbd></dt>
<dd><p>Number of samples of attention to be saved</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--num-save-ctc</kbd></dt>
<dd><p>Number of samples of CTC probability to be saved</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--grad-noise</kbd></dt>
<dd><p>The flag to switch to use noise injection to gradients during training</p>
<p>Default: False</p>
</dd>
<dt><kbd>--num-spkrs</kbd></dt>
<dd><p>Possible choices: 1, 2</p>
<p>Number of speakers in the speech.</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--context-residual</kbd></dt>
<dd><p>The flag to switch to use context vector residual in the decoder network</p>
<p>Default: False</p>
</dd>
<dt><kbd>--enc-init</kbd></dt>
<dd><p>Pre-trained ASR model to initialize encoder.</p>
</dd>
<dt><kbd>--enc-init-mods</kbd></dt>
<dd><p>List of encoder modules to initialize, separated by a comma.</p>
<p>Default: enc.enc.</p>
</dd>
<dt><kbd>--dec-init</kbd></dt>
<dd><p>Pre-trained ASR, MT or LM model to initialize decoder.</p>
</dd>
<dt><kbd>--dec-init-mods</kbd></dt>
<dd><p>List of decoder modules to initialize, separated by a comma.</p>
<p>Default: att.,dec.</p>
</dd>
<dt><kbd>--freeze-mods</kbd></dt>
<dd><p>List of modules to freeze, separated by a comma.</p>
</dd>
<dt><kbd>--use-frontend</kbd></dt>
<dd><p>The flag to switch to use frontend system.</p>
<p>Default: False</p>
</dd>
<dt><kbd>--use-wpe</kbd></dt>
<dd><p>Apply Weighted Prediction Error</p>
<p>Default: False</p>
</dd>
<dt><kbd>--wtype</kbd></dt>
<dd><p>Possible choices: lstm, blstm, lstmp, blstmp, vgglstmp, vggblstmp, vgglstm, vggblstm, gru, bgru, grup, bgrup, vgggrup, vggbgrup, vgggru, vggbgru</p>
<p>Type of encoder network architecture of the mask estimator for WPE.</p>
<p>Default: “blstmp”</p>
</dd>
<dt><kbd>--wlayers</kbd></dt>
<dd><p>Default: 2</p>
</dd>
<dt><kbd>--wunits</kbd></dt>
<dd><p>Default: 300</p>
</dd>
<dt><kbd>--wprojs</kbd></dt>
<dd><p>Default: 300</p>
</dd>
<dt><kbd>--wdropout-rate</kbd></dt>
<dd><p>Default: 0.0</p>
</dd>
<dt><kbd>--wpe-taps</kbd></dt>
<dd><p>Default: 5</p>
</dd>
<dt><kbd>--wpe-delay</kbd></dt>
<dd><p>Default: 3</p>
</dd>
<dt><kbd>--use-dnn-mask-for-wpe</kbd></dt>
<dd><p>Use DNN to estimate the power spectrogram. This option is experimental.</p>
<p>Default: False</p>
</dd>
<dt><kbd>--use-beamformer</kbd></dt>
<dd><p>Default: True</p>
</dd>
<dt><kbd>--btype</kbd></dt>
<dd><p>Possible choices: lstm, blstm, lstmp, blstmp, vgglstmp, vggblstmp, vgglstm, vggblstm, gru, bgru, grup, bgrup, vgggrup, vggbgrup, vgggru, vggbgru</p>
<p>Type of encoder network architecture of the mask estimator for Beamformer.</p>
<p>Default: “blstmp”</p>
</dd>
<dt><kbd>--blayers</kbd></dt>
<dd><p>Default: 2</p>
</dd>
<dt><kbd>--bunits</kbd></dt>
<dd><p>Default: 300</p>
</dd>
<dt><kbd>--bprojs</kbd></dt>
<dd><p>Default: 300</p>
</dd>
<dt><kbd>--badim</kbd></dt>
<dd><p>Default: 320</p>
</dd>
<dt><kbd>--bnmask</kbd></dt>
<dd><p>Number of beamforming masks, default is 2 for [speech, noise].</p>
<p>Default: 2</p>
</dd>
<dt><kbd>--ref-channel</kbd></dt>
<dd><p>The reference channel used for beamformer. By default, the channel is estimated by DNN.</p>
<p>Default: -1</p>
</dd>
<dt><kbd>--bdropout-rate</kbd></dt>
<dd><p>Default: 0.0</p>
</dd>
<dt><kbd>--stats-file</kbd></dt>
<dd><p>The stats file for the feature normalization</p>
</dd>
<dt><kbd>--apply-uttmvn</kbd></dt>
<dd><p>Apply utterance level mean variance normalization.</p>
<p>Default: True</p>
</dd>
<dt><kbd>--uttmvn-norm-means</kbd></dt>
<dd><p>Default: True</p>
</dd>
<dt><kbd>--uttmvn-norm-vars</kbd></dt>
<dd><p>Default: False</p>
</dd>
<dt><kbd>--fbank-fs</kbd></dt>
<dd><p>The sample frequency used for the mel-fbank creation.</p>
<p>Default: 16000</p>
</dd>
<dt><kbd>--n-mels</kbd></dt>
<dd><p>The number of mel-frequency bins.</p>
<p>Default: 80</p>
</dd>
<dt><kbd>--fbank-fmin</kbd></dt>
<dd><p>Default: 0.0</p>
</dd>
<dt><kbd>--fbank-fmax</kbd></dt>
<dd></dd>
</dl>
</section>
</section>
<section id="lm-train-py">
<span id="id6"></span><h2>lm_train.py<a class="headerlink" href="#lm-train-py" title="Permalink to this headline">¶</a></h2>
<p><p>Train a new language model on one CPU or one GPU</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">lm_train</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config2</span> <span class="n">CONFIG2</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">config3</span> <span class="n">CONFIG3</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">train</span><span class="o">-</span><span class="n">dtype</span> <span class="p">{</span><span class="n">float16</span><span class="p">,</span><span class="n">float32</span><span class="p">,</span><span class="n">float64</span><span class="p">,</span><span class="n">O0</span><span class="p">,</span><span class="n">O1</span><span class="p">,</span><span class="n">O2</span><span class="p">,</span><span class="n">O3</span><span class="p">}]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">chainer</span><span class="p">,</span><span class="n">pytorch</span><span class="p">}]</span> <span class="o">--</span><span class="n">outdir</span> <span class="n">OUTDIR</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span> <span class="o">--</span><span class="nb">dict</span> <span class="n">DICT</span> <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">resume</span> <span class="p">[</span><span class="n">RESUME</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">tensorboard</span><span class="o">-</span><span class="nb">dir</span> <span class="p">[</span><span class="n">TENSORBOARD_DIR</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">report</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">iters</span> <span class="n">REPORT_INTERVAL_ITERS</span><span class="p">]</span>
                   <span class="o">--</span><span class="n">train</span><span class="o">-</span><span class="n">label</span> <span class="n">TRAIN_LABEL</span> <span class="o">--</span><span class="n">valid</span><span class="o">-</span><span class="n">label</span> <span class="n">VALID_LABEL</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">test</span><span class="o">-</span><span class="n">label</span> <span class="n">TEST_LABEL</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">dump</span><span class="o">-</span><span class="n">hdf5</span><span class="o">-</span><span class="n">path</span> <span class="n">DUMP_HDF5_PATH</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">opt</span> <span class="n">OPT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">sortagrad</span> <span class="p">[</span><span class="n">SORTAGRAD</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batchsize</span> <span class="n">BATCHSIZE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">accum</span><span class="o">-</span><span class="n">grad</span> <span class="n">ACCUM_GRAD</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">epoch</span> <span class="n">EPOCH</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">early</span><span class="o">-</span><span class="n">stop</span><span class="o">-</span><span class="n">criterion</span> <span class="p">[</span><span class="n">EARLY_STOP_CRITERION</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">patience</span> <span class="p">[</span><span class="n">PATIENCE</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">schedulers</span> <span class="n">SCHEDULERS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">gradclip</span> <span class="n">GRADCLIP</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">maxlen</span> <span class="n">MAXLEN</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">module</span> <span class="n">MODEL_MODULE</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>config file path</p>
</dd>
<dt><kbd>--config2</kbd></dt>
<dd><p>second config file path that overwrites the settings in <cite>–config</cite>.</p>
</dd>
<dt><kbd>--config3</kbd></dt>
<dd><p>third config file path that overwrites the settings in <cite>–config</cite> and <cite>–config2</cite>.</p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs. If not given, use all visible devices</p>
</dd>
<dt><kbd>--train-dtype</kbd></dt>
<dd><p>Possible choices: float16, float32, float64, O0, O1, O2, O3</p>
<p>Data type for training (only pytorch backend). O0,O1,.. flags require apex. See <a class="reference external" href="https://nvidia.github.io/apex/amp.html#opt-levels">https://nvidia.github.io/apex/amp.html#opt-levels</a></p>
<p>Default: “float32”</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: chainer, pytorch</p>
<p>Backend library</p>
<p>Default: “chainer”</p>
</dd>
<dt><kbd>--outdir</kbd></dt>
<dd><p>Output directory</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--dict</kbd></dt>
<dd><p>Dictionary</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>Random seed</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--resume, -r</kbd></dt>
<dd><p>Resume the training from snapshot</p>
<p>Default: “”</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--tensorboard-dir</kbd></dt>
<dd><p>Tensorboard log dir path</p>
</dd>
<dt><kbd>--report-interval-iters</kbd></dt>
<dd><p>Report interval iterations</p>
<p>Default: 100</p>
</dd>
<dt><kbd>--train-label</kbd></dt>
<dd><p>Filename of train label data</p>
</dd>
<dt><kbd>--valid-label</kbd></dt>
<dd><p>Filename of validation label data</p>
</dd>
<dt><kbd>--test-label</kbd></dt>
<dd><p>Filename of test label data</p>
</dd>
<dt><kbd>--dump-hdf5-path</kbd></dt>
<dd><p>Path to dump a preprocessed dataset as hdf5</p>
</dd>
<dt><kbd>--opt</kbd></dt>
<dd><p>Optimizer</p>
<p>Default: “sgd”</p>
</dd>
<dt><kbd>--sortagrad</kbd></dt>
<dd><p>How many epochs to use sortagrad for. 0 = deactivated, -1 = all epochs</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batchsize, -b</kbd></dt>
<dd><p>Number of examples in each mini-batch</p>
<p>Default: 300</p>
</dd>
<dt><kbd>--accum-grad</kbd></dt>
<dd><p>Number of gradient accumueration</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--epoch, -e</kbd></dt>
<dd><p>Number of sweeps over the dataset to train</p>
<p>Default: 20</p>
</dd>
<dt><kbd>--early-stop-criterion</kbd></dt>
<dd><p>Value to monitor to trigger an early stopping of the training</p>
<p>Default: “validation/main/loss”</p>
</dd>
<dt><kbd>--patience</kbd></dt>
<dd><p>Number of epochs to wait without improvement before stopping the training</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--schedulers</kbd></dt>
<dd><p>optimizer schedulers, you can configure params like: &lt;optimizer-param&gt;-&lt;scheduler-name&gt;-&lt;schduler-param&gt; e.g., “–schedulers lr=noam –lr-noam-warmup 1000”.</p>
</dd>
<dt><kbd>--gradclip, -c</kbd></dt>
<dd><p>Gradient norm threshold to clip</p>
<p>Default: 5</p>
</dd>
<dt><kbd>--maxlen</kbd></dt>
<dd><p>Batch size is reduced if the input sequence &gt; ML</p>
<p>Default: 40</p>
</dd>
<dt><kbd>--model-module</kbd></dt>
<dd><p>model defined module (default: espnet.nets.xxx_backend.lm.default:DefaultRNNLM)</p>
<p>Default: “default”</p>
</dd>
</dl>
</section>
</section>
<section id="mt-train-py">
<span id="id7"></span><h2>mt_train.py<a class="headerlink" href="#mt-train-py" title="Permalink to this headline">¶</a></h2>
<p><p>Train a neural machine translation (NMT) model on one CPU, one or multiple GPUs</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">mt_train</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config2</span> <span class="n">CONFIG2</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">config3</span> <span class="n">CONFIG3</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">train</span><span class="o">-</span><span class="n">dtype</span> <span class="p">{</span><span class="n">float16</span><span class="p">,</span><span class="n">float32</span><span class="p">,</span><span class="n">float64</span><span class="p">,</span><span class="n">O0</span><span class="p">,</span><span class="n">O1</span><span class="p">,</span><span class="n">O2</span><span class="p">,</span><span class="n">O3</span><span class="p">}]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">chainer</span><span class="p">,</span><span class="n">pytorch</span><span class="p">}]</span> <span class="o">--</span><span class="n">outdir</span> <span class="n">OUTDIR</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span> <span class="o">--</span><span class="nb">dict</span> <span class="n">DICT</span> <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">debugdir</span> <span class="n">DEBUGDIR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">resume</span> <span class="p">[</span><span class="n">RESUME</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">minibatches</span> <span class="n">MINIBATCHES</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">tensorboard</span><span class="o">-</span><span class="nb">dir</span> <span class="p">[</span><span class="n">TENSORBOARD_DIR</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">report</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">iters</span> <span class="n">REPORT_INTERVAL_ITERS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">iters</span> <span class="n">SAVE_INTERVAL_ITERS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">train</span><span class="o">-</span><span class="n">json</span> <span class="n">TRAIN_JSON</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">valid</span><span class="o">-</span><span class="n">json</span> <span class="n">VALID_JSON</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">module</span> <span class="n">MODEL_MODULE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lsm</span><span class="o">-</span><span class="n">weight</span> <span class="n">LSM_WEIGHT</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">report</span><span class="o">-</span><span class="n">bleu</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">nbest</span> <span class="n">NBEST</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">beam</span><span class="o">-</span><span class="n">size</span> <span class="n">BEAM_SIZE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">penalty</span> <span class="n">PENALTY</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">maxlenratio</span> <span class="n">MAXLENRATIO</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">minlenratio</span> <span class="n">MINLENRATIO</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">rnnlm</span> <span class="n">RNNLM</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">rnnlm</span><span class="o">-</span><span class="n">conf</span> <span class="n">RNNLM_CONF</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lm</span><span class="o">-</span><span class="n">weight</span> <span class="n">LM_WEIGHT</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">sym</span><span class="o">-</span><span class="n">space</span> <span class="n">SYM_SPACE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">sym</span><span class="o">-</span><span class="n">blank</span> <span class="n">SYM_BLANK</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">sortagrad</span> <span class="p">[</span><span class="n">SORTAGRAD</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">count</span> <span class="p">{</span><span class="n">auto</span><span class="p">,</span><span class="n">seq</span><span class="p">,</span><span class="nb">bin</span><span class="p">,</span><span class="n">frame</span><span class="p">}]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">size</span> <span class="n">BATCH_SIZE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">bins</span> <span class="n">BATCH_BINS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="ow">in</span> <span class="n">BATCH_FRAMES_IN</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="n">out</span> <span class="n">BATCH_FRAMES_OUT</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="n">inout</span> <span class="n">BATCH_FRAMES_INOUT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">maxlen</span><span class="o">-</span><span class="ow">in</span> <span class="n">ML</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">maxlen</span><span class="o">-</span><span class="n">out</span> <span class="n">ML</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">n</span><span class="o">-</span><span class="nb">iter</span><span class="o">-</span><span class="n">processes</span> <span class="n">N_ITER_PROCESSES</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">opt</span> <span class="p">{</span><span class="n">adadelta</span><span class="p">,</span><span class="n">adam</span><span class="p">,</span><span class="n">noam</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">accum</span><span class="o">-</span><span class="n">grad</span> <span class="n">ACCUM_GRAD</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">eps</span> <span class="n">EPS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">eps</span><span class="o">-</span><span class="n">decay</span> <span class="n">EPS_DECAY</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lr</span> <span class="n">LR</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">lr</span><span class="o">-</span><span class="n">decay</span> <span class="n">LR_DECAY</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">weight</span><span class="o">-</span><span class="n">decay</span> <span class="n">WEIGHT_DECAY</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">criterion</span> <span class="p">{</span><span class="n">loss</span><span class="p">,</span><span class="n">acc</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">threshold</span> <span class="n">THRESHOLD</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">epochs</span> <span class="n">EPOCHS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">early</span><span class="o">-</span><span class="n">stop</span><span class="o">-</span><span class="n">criterion</span> <span class="p">[</span><span class="n">EARLY_STOP_CRITERION</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">patience</span> <span class="p">[</span><span class="n">PATIENCE</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">grad</span><span class="o">-</span><span class="n">clip</span> <span class="n">GRAD_CLIP</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">save</span><span class="o">-</span><span class="n">attention</span> <span class="n">NUM_SAVE_ATTENTION</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">context</span><span class="o">-</span><span class="n">residual</span> <span class="p">[</span><span class="n">CONTEXT_RESIDUAL</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">tie</span><span class="o">-</span><span class="n">src</span><span class="o">-</span><span class="n">tgt</span><span class="o">-</span><span class="n">embedding</span> <span class="p">[</span><span class="n">TIE_SRC_TGT_EMBEDDING</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">tie</span><span class="o">-</span><span class="n">classifier</span> <span class="p">[</span><span class="n">TIE_CLASSIFIER</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">enc</span><span class="o">-</span><span class="n">init</span> <span class="p">[</span><span class="n">ENC_INIT</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">enc</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">mods</span> <span class="n">ENC_INIT_MODS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">dec</span><span class="o">-</span><span class="n">init</span> <span class="p">[</span><span class="n">DEC_INIT</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">dec</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">mods</span> <span class="n">DEC_INIT_MODS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">multilingual</span> <span class="n">MULTILINGUAL</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">replace</span><span class="o">-</span><span class="n">sos</span> <span class="n">REPLACE_SOS</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>config file path</p>
</dd>
<dt><kbd>--config2</kbd></dt>
<dd><p>second config file path that overwrites the settings in <cite>–config</cite>.</p>
</dd>
<dt><kbd>--config3</kbd></dt>
<dd><p>third config file path that overwrites the settings in <cite>–config</cite> and <cite>–config2</cite>.</p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs. If not given, use all visible devices</p>
</dd>
<dt><kbd>--train-dtype</kbd></dt>
<dd><p>Possible choices: float16, float32, float64, O0, O1, O2, O3</p>
<p>Data type for training (only pytorch backend). O0,O1,.. flags require apex. See <a class="reference external" href="https://nvidia.github.io/apex/amp.html#opt-levels">https://nvidia.github.io/apex/amp.html#opt-levels</a></p>
<p>Default: “float32”</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: chainer, pytorch</p>
<p>Backend library</p>
<p>Default: “chainer”</p>
</dd>
<dt><kbd>--outdir</kbd></dt>
<dd><p>Output directory</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--dict</kbd></dt>
<dd><p>Dictionary for source/target languages</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>Random seed</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--debugdir</kbd></dt>
<dd><p>Output directory for debugging</p>
</dd>
<dt><kbd>--resume, -r</kbd></dt>
<dd><p>Resume the training from snapshot</p>
<p>Default: “”</p>
</dd>
<dt><kbd>--minibatches, -N</kbd></dt>
<dd><p>Process only N minibatches (for debug)</p>
<p>Default: -1</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--tensorboard-dir</kbd></dt>
<dd><p>Tensorboard log dir path</p>
</dd>
<dt><kbd>--report-interval-iters</kbd></dt>
<dd><p>Report interval iterations</p>
<p>Default: 100</p>
</dd>
<dt><kbd>--save-interval-iters</kbd></dt>
<dd><p>Save snapshot interval iterations</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--train-json</kbd></dt>
<dd><p>Filename of train label data (json)</p>
</dd>
<dt><kbd>--valid-json</kbd></dt>
<dd><p>Filename of validation label data (json)</p>
</dd>
<dt><kbd>--model-module</kbd></dt>
<dd><p>model defined module (default: espnet.nets.xxx_backend.e2e_mt:E2E)</p>
</dd>
<dt><kbd>--lsm-weight</kbd></dt>
<dd><p>Label smoothing weight</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--report-bleu</kbd></dt>
<dd><p>Compute BLEU on development set</p>
<p>Default: True</p>
</dd>
<dt><kbd>--nbest</kbd></dt>
<dd><p>Output N-best hypotheses</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--beam-size</kbd></dt>
<dd><p>Beam size</p>
<p>Default: 4</p>
</dd>
<dt><kbd>--penalty</kbd></dt>
<dd><p>Incertion penalty</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--maxlenratio</kbd></dt>
<dd><dl class="simple">
<dt>Input length ratio to obtain max output length.</dt><dd><p>If maxlenratio=0.0 (default), it uses a end-detect function
to automatically find maximum hypothesis lengths</p>
</dd>
</dl>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--minlenratio</kbd></dt>
<dd><p>Input length ratio to obtain min output length</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--rnnlm</kbd></dt>
<dd><p>RNNLM model file to read</p>
</dd>
<dt><kbd>--rnnlm-conf</kbd></dt>
<dd><p>RNNLM model config file to read</p>
</dd>
<dt><kbd>--lm-weight</kbd></dt>
<dd><p>RNNLM weight.</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--sym-space</kbd></dt>
<dd><p>Space symbol</p>
<p>Default: “&lt;space&gt;”</p>
</dd>
<dt><kbd>--sym-blank</kbd></dt>
<dd><p>Blank symbol</p>
<p>Default: “&lt;blank&gt;”</p>
</dd>
<dt><kbd>--sortagrad</kbd></dt>
<dd><p>How many epochs to use sortagrad for. 0 = deactivated, -1 = all epochs</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-count</kbd></dt>
<dd><p>Possible choices: auto, seq, bin, frame</p>
<p>How to count batch_size. The default (auto) will find how to count by args.</p>
<p>Default: “auto”</p>
</dd>
<dt><kbd>--batch-size, --batch-seqs, -b</kbd></dt>
<dd><p>Maximum seqs in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-bins</kbd></dt>
<dd><p>Maximum bins in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-in</kbd></dt>
<dd><p>Maximum input frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-out</kbd></dt>
<dd><p>Maximum output frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-inout</kbd></dt>
<dd><p>Maximum input+output frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--maxlen-in, --batch-seq-maxlen-in</kbd></dt>
<dd><p>When –batch-count=seq, batch size is reduced if the input sequence length &gt; ML.</p>
<p>Default: 100</p>
</dd>
<dt><kbd>--maxlen-out, --batch-seq-maxlen-out</kbd></dt>
<dd><p>When –batch-count=seq, batch size is reduced if the output sequence length &gt; ML</p>
<p>Default: 100</p>
</dd>
<dt><kbd>--n-iter-processes</kbd></dt>
<dd><p>Number of processes of iterator</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--opt</kbd></dt>
<dd><p>Possible choices: adadelta, adam, noam</p>
<p>Optimizer</p>
<p>Default: “adadelta”</p>
</dd>
<dt><kbd>--accum-grad</kbd></dt>
<dd><p>Number of gradient accumuration</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--eps</kbd></dt>
<dd><p>Epsilon constant for optimizer</p>
<p>Default: 1e-08</p>
</dd>
<dt><kbd>--eps-decay</kbd></dt>
<dd><p>Decaying ratio of epsilon</p>
<p>Default: 0.01</p>
</dd>
<dt><kbd>--lr</kbd></dt>
<dd><p>Learning rate for optimizer</p>
<p>Default: 0.001</p>
</dd>
<dt><kbd>--lr-decay</kbd></dt>
<dd><p>Decaying ratio of learning rate</p>
<p>Default: 1.0</p>
</dd>
<dt><kbd>--weight-decay</kbd></dt>
<dd><p>Weight decay ratio</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--criterion</kbd></dt>
<dd><p>Possible choices: loss, acc</p>
<p>Criterion to perform epsilon decay</p>
<p>Default: “acc”</p>
</dd>
<dt><kbd>--threshold</kbd></dt>
<dd><p>Threshold to stop iteration</p>
<p>Default: 0.0001</p>
</dd>
<dt><kbd>--epochs, -e</kbd></dt>
<dd><p>Maximum number of epochs</p>
<p>Default: 30</p>
</dd>
<dt><kbd>--early-stop-criterion</kbd></dt>
<dd><p>Value to monitor to trigger an early stopping of the training</p>
<p>Default: “validation/main/acc”</p>
</dd>
<dt><kbd>--patience</kbd></dt>
<dd><p>Number of epochs to wait without improvement before stopping the training</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--grad-clip</kbd></dt>
<dd><p>Gradient norm threshold to clip</p>
<p>Default: 5</p>
</dd>
<dt><kbd>--num-save-attention</kbd></dt>
<dd><p>Number of samples of attention to be saved</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--context-residual</kbd></dt>
<dd><p>The flag to switch to use context vector residual in the decoder network</p>
<p>Default: False</p>
</dd>
<dt><kbd>--tie-src-tgt-embedding</kbd></dt>
<dd><p>Tie parameters of source embedding and target embedding.</p>
<p>Default: False</p>
</dd>
<dt><kbd>--tie-classifier</kbd></dt>
<dd><p>Tie parameters of target embedding and output projection layer.</p>
<p>Default: False</p>
</dd>
<dt><kbd>--enc-init</kbd></dt>
<dd><p>Pre-trained ASR model to initialize encoder.</p>
</dd>
<dt><kbd>--enc-init-mods</kbd></dt>
<dd><p>List of encoder modules to initialize, separated by a comma.</p>
<p>Default: enc.enc.</p>
</dd>
<dt><kbd>--dec-init</kbd></dt>
<dd><p>Pre-trained ASR, MT or LM model to initialize decoder.</p>
</dd>
<dt><kbd>--dec-init-mods</kbd></dt>
<dd><p>List of decoder modules to initialize, separated by a comma.</p>
<p>Default: att., dec.</p>
</dd>
<dt><kbd>--multilingual</kbd></dt>
<dd><p>Prepend target language ID to the source sentence. Both source/target language IDs must be prepend in the pre-processing stage.</p>
<p>Default: False</p>
</dd>
<dt><kbd>--replace-sos</kbd></dt>
<dd><p>Replace &lt;sos&gt; in the decoder with a target language ID (the first token in the target sequence)</p>
<p>Default: False</p>
</dd>
</dl>
</section>
</section>
<section id="mt-trans-py">
<span id="id8"></span><h2>mt_trans.py<a class="headerlink" href="#mt-trans-py" title="Permalink to this headline">¶</a></h2>
<p><p>Translate text from speech using a speech translation model on one CPU or GPU</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">mt_trans</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config2</span> <span class="n">CONFIG2</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">config3</span> <span class="n">CONFIG3</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">dtype</span> <span class="p">{</span><span class="n">float16</span><span class="p">,</span><span class="n">float32</span><span class="p">,</span><span class="n">float64</span><span class="p">}]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">chainer</span><span class="p">,</span><span class="n">pytorch</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">batchsize</span> <span class="n">BATCHSIZE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">preprocess</span><span class="o">-</span><span class="n">conf</span> <span class="n">PREPROCESS_CONF</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">api</span> <span class="p">{</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">}]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">trans</span><span class="o">-</span><span class="n">json</span> <span class="n">TRANS_JSON</span><span class="p">]</span> <span class="o">--</span><span class="n">result</span><span class="o">-</span><span class="n">label</span> <span class="n">RESULT_LABEL</span>
                   <span class="o">--</span><span class="n">model</span> <span class="n">MODEL</span> <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">conf</span> <span class="n">MODEL_CONF</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">nbest</span> <span class="n">NBEST</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">beam</span><span class="o">-</span><span class="n">size</span> <span class="n">BEAM_SIZE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">penalty</span> <span class="n">PENALTY</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">maxlenratio</span> <span class="n">MAXLENRATIO</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">minlenratio</span> <span class="n">MINLENRATIO</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">tgt</span><span class="o">-</span><span class="n">lang</span> <span class="n">TGT_LANG</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>Config file path</p>
</dd>
<dt><kbd>--config2</kbd></dt>
<dd><p>Second config file path that overwrites the settings in <cite>–config</cite></p>
</dd>
<dt><kbd>--config3</kbd></dt>
<dd><p>Third config file path that overwrites the settings in <cite>–config</cite> and <cite>–config2</cite></p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--dtype</kbd></dt>
<dd><p>Possible choices: float16, float32, float64</p>
<p>Float precision (only available in –api v2)</p>
<p>Default: “float32”</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: chainer, pytorch</p>
<p>Backend library</p>
<p>Default: “chainer”</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>Random seed</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--batchsize</kbd></dt>
<dd><p>Batch size for beam search (0: means no batch processing)</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--preprocess-conf</kbd></dt>
<dd><p>The configuration file for the pre-processing</p>
</dd>
<dt><kbd>--api</kbd></dt>
<dd><p>Possible choices: v1, v2</p>
<p>Beam search APIs v1: Default API. It only supports the ASRInterface.recognize method and DefaultRNNLM. v2: Experimental API. It supports any models that implements ScorerInterface.</p>
<p>Default: “v1”</p>
</dd>
<dt><kbd>--trans-json</kbd></dt>
<dd><p>Filename of translation data (json)</p>
</dd>
<dt><kbd>--result-label</kbd></dt>
<dd><p>Filename of result label data (json)</p>
</dd>
<dt><kbd>--model</kbd></dt>
<dd><p>Model file parameters to read</p>
</dd>
<dt><kbd>--model-conf</kbd></dt>
<dd><p>Model config file</p>
</dd>
<dt><kbd>--nbest</kbd></dt>
<dd><p>Output N-best hypotheses</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--beam-size</kbd></dt>
<dd><p>Beam size</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--penalty</kbd></dt>
<dd><p>Incertion penalty</p>
<p>Default: 0.1</p>
</dd>
<dt><kbd>--maxlenratio</kbd></dt>
<dd><dl class="simple">
<dt>Input length ratio to obtain max output length.</dt><dd><p>If maxlenratio=0.0 (default), it uses a end-detect function
to automatically find maximum hypothesis lengths</p>
</dd>
</dl>
<p>Default: 3.0</p>
</dd>
<dt><kbd>--minlenratio</kbd></dt>
<dd><p>Input length ratio to obtain min output length</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--tgt-lang</kbd></dt>
<dd><p>target language ID (e.g., &lt;en&gt;, &lt;de&gt;, and &lt;fr&gt; etc.)</p>
<p>Default: False</p>
</dd>
</dl>
</section>
</section>
<section id="st-train-py">
<span id="id9"></span><h2>st_train.py<a class="headerlink" href="#st-train-py" title="Permalink to this headline">¶</a></h2>
<p><p>Train a speech translation (ST) model on one CPU, one or multiple GPUs</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">st_train</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config2</span> <span class="n">CONFIG2</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">config3</span> <span class="n">CONFIG3</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">train</span><span class="o">-</span><span class="n">dtype</span> <span class="p">{</span><span class="n">float16</span><span class="p">,</span><span class="n">float32</span><span class="p">,</span><span class="n">float64</span><span class="p">,</span><span class="n">O0</span><span class="p">,</span><span class="n">O1</span><span class="p">,</span><span class="n">O2</span><span class="p">,</span><span class="n">O3</span><span class="p">}]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">chainer</span><span class="p">,</span><span class="n">pytorch</span><span class="p">}]</span> <span class="o">--</span><span class="n">outdir</span> <span class="n">OUTDIR</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span> <span class="o">--</span><span class="nb">dict</span> <span class="n">DICT</span> <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">debugdir</span> <span class="n">DEBUGDIR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">resume</span> <span class="p">[</span><span class="n">RESUME</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">minibatches</span> <span class="n">MINIBATCHES</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">tensorboard</span><span class="o">-</span><span class="nb">dir</span> <span class="p">[</span><span class="n">TENSORBOARD_DIR</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">report</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">iters</span> <span class="n">REPORT_INTERVAL_ITERS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">iters</span> <span class="n">SAVE_INTERVAL_ITERS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">train</span><span class="o">-</span><span class="n">json</span> <span class="n">TRAIN_JSON</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">valid</span><span class="o">-</span><span class="n">json</span> <span class="n">VALID_JSON</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">module</span> <span class="n">MODEL_MODULE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">ctc_type</span> <span class="p">{</span><span class="n">builtin</span><span class="p">,</span><span class="n">warpctc</span><span class="p">,</span><span class="n">gtnctc</span><span class="p">,</span><span class="n">cudnnctc</span><span class="p">}]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">mtlalpha</span> <span class="n">MTLALPHA</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">asr</span><span class="o">-</span><span class="n">weight</span> <span class="n">ASR_WEIGHT</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">mt</span><span class="o">-</span><span class="n">weight</span> <span class="n">MT_WEIGHT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lsm</span><span class="o">-</span><span class="n">weight</span> <span class="n">LSM_WEIGHT</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">report</span><span class="o">-</span><span class="n">cer</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">report</span><span class="o">-</span><span class="n">wer</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">report</span><span class="o">-</span><span class="n">bleu</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">nbest</span> <span class="n">NBEST</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">beam</span><span class="o">-</span><span class="n">size</span> <span class="n">BEAM_SIZE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">penalty</span> <span class="n">PENALTY</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">maxlenratio</span> <span class="n">MAXLENRATIO</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">minlenratio</span> <span class="n">MINLENRATIO</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">rnnlm</span> <span class="n">RNNLM</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">rnnlm</span><span class="o">-</span><span class="n">conf</span> <span class="n">RNNLM_CONF</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">lm</span><span class="o">-</span><span class="n">weight</span> <span class="n">LM_WEIGHT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">sym</span><span class="o">-</span><span class="n">space</span> <span class="n">SYM_SPACE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">sym</span><span class="o">-</span><span class="n">blank</span> <span class="n">SYM_BLANK</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">sortagrad</span> <span class="p">[</span><span class="n">SORTAGRAD</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">count</span> <span class="p">{</span><span class="n">auto</span><span class="p">,</span><span class="n">seq</span><span class="p">,</span><span class="nb">bin</span><span class="p">,</span><span class="n">frame</span><span class="p">}]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">size</span> <span class="n">BATCH_SIZE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">bins</span> <span class="n">BATCH_BINS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="ow">in</span> <span class="n">BATCH_FRAMES_IN</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="n">out</span> <span class="n">BATCH_FRAMES_OUT</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="n">inout</span> <span class="n">BATCH_FRAMES_INOUT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">maxlen</span><span class="o">-</span><span class="ow">in</span> <span class="n">ML</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">maxlen</span><span class="o">-</span><span class="n">out</span> <span class="n">ML</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">n</span><span class="o">-</span><span class="nb">iter</span><span class="o">-</span><span class="n">processes</span> <span class="n">N_ITER_PROCESSES</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">preprocess</span><span class="o">-</span><span class="n">conf</span> <span class="p">[</span><span class="n">PREPROCESS_CONF</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">opt</span> <span class="p">{</span><span class="n">adadelta</span><span class="p">,</span><span class="n">adam</span><span class="p">,</span><span class="n">noam</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">accum</span><span class="o">-</span><span class="n">grad</span> <span class="n">ACCUM_GRAD</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">eps</span> <span class="n">EPS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">eps</span><span class="o">-</span><span class="n">decay</span> <span class="n">EPS_DECAY</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lr</span> <span class="n">LR</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">lr</span><span class="o">-</span><span class="n">decay</span> <span class="n">LR_DECAY</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">weight</span><span class="o">-</span><span class="n">decay</span> <span class="n">WEIGHT_DECAY</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">criterion</span> <span class="p">{</span><span class="n">loss</span><span class="p">,</span><span class="n">acc</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">threshold</span> <span class="n">THRESHOLD</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">epochs</span> <span class="n">EPOCHS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">early</span><span class="o">-</span><span class="n">stop</span><span class="o">-</span><span class="n">criterion</span> <span class="p">[</span><span class="n">EARLY_STOP_CRITERION</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">patience</span> <span class="p">[</span><span class="n">PATIENCE</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">grad</span><span class="o">-</span><span class="n">clip</span> <span class="n">GRAD_CLIP</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">save</span><span class="o">-</span><span class="n">attention</span> <span class="n">NUM_SAVE_ATTENTION</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">save</span><span class="o">-</span><span class="n">ctc</span> <span class="n">NUM_SAVE_CTC</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">grad</span><span class="o">-</span><span class="n">noise</span> <span class="n">GRAD_NOISE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">context</span><span class="o">-</span><span class="n">residual</span> <span class="p">[</span><span class="n">CONTEXT_RESIDUAL</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">enc</span><span class="o">-</span><span class="n">init</span> <span class="p">[</span><span class="n">ENC_INIT</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">enc</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">mods</span> <span class="n">ENC_INIT_MODS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">dec</span><span class="o">-</span><span class="n">init</span> <span class="p">[</span><span class="n">DEC_INIT</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">dec</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">mods</span> <span class="n">DEC_INIT_MODS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">multilingual</span> <span class="n">MULTILINGUAL</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">replace</span><span class="o">-</span><span class="n">sos</span> <span class="n">REPLACE_SOS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">stats</span><span class="o">-</span><span class="n">file</span> <span class="n">STATS_FILE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">apply</span><span class="o">-</span><span class="n">uttmvn</span> <span class="n">APPLY_UTTMVN</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">uttmvn</span><span class="o">-</span><span class="n">norm</span><span class="o">-</span><span class="n">means</span> <span class="n">UTTMVN_NORM_MEANS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">uttmvn</span><span class="o">-</span><span class="n">norm</span><span class="o">-</span><span class="nb">vars</span> <span class="n">UTTMVN_NORM_VARS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">fbank</span><span class="o">-</span><span class="n">fs</span> <span class="n">FBANK_FS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">n</span><span class="o">-</span><span class="n">mels</span> <span class="n">N_MELS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">fbank</span><span class="o">-</span><span class="n">fmin</span> <span class="n">FBANK_FMIN</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">fbank</span><span class="o">-</span><span class="n">fmax</span> <span class="n">FBANK_FMAX</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>config file path</p>
</dd>
<dt><kbd>--config2</kbd></dt>
<dd><p>second config file path that overwrites the settings in <cite>–config</cite>.</p>
</dd>
<dt><kbd>--config3</kbd></dt>
<dd><p>third config file path that overwrites the settings in <cite>–config</cite> and <cite>–config2</cite>.</p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs. If not given, use all visible devices</p>
</dd>
<dt><kbd>--train-dtype</kbd></dt>
<dd><p>Possible choices: float16, float32, float64, O0, O1, O2, O3</p>
<p>Data type for training (only pytorch backend). O0,O1,.. flags require apex. See <a class="reference external" href="https://nvidia.github.io/apex/amp.html#opt-levels">https://nvidia.github.io/apex/amp.html#opt-levels</a></p>
<p>Default: “float32”</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: chainer, pytorch</p>
<p>Backend library</p>
<p>Default: “chainer”</p>
</dd>
<dt><kbd>--outdir</kbd></dt>
<dd><p>Output directory</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--dict</kbd></dt>
<dd><p>Dictionary</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>Random seed</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--debugdir</kbd></dt>
<dd><p>Output directory for debugging</p>
</dd>
<dt><kbd>--resume, -r</kbd></dt>
<dd><p>Resume the training from snapshot</p>
<p>Default: “”</p>
</dd>
<dt><kbd>--minibatches, -N</kbd></dt>
<dd><p>Process only N minibatches (for debug)</p>
<p>Default: -1</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--tensorboard-dir</kbd></dt>
<dd><p>Tensorboard log dir path</p>
</dd>
<dt><kbd>--report-interval-iters</kbd></dt>
<dd><p>Report interval iterations</p>
<p>Default: 100</p>
</dd>
<dt><kbd>--save-interval-iters</kbd></dt>
<dd><p>Save snapshot interval iterations</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--train-json</kbd></dt>
<dd><p>Filename of train label data (json)</p>
</dd>
<dt><kbd>--valid-json</kbd></dt>
<dd><p>Filename of validation label data (json)</p>
</dd>
<dt><kbd>--model-module</kbd></dt>
<dd><p>model defined module (default: espnet.nets.xxx_backend.e2e_st:E2E)</p>
</dd>
<dt><kbd>--ctc_type</kbd></dt>
<dd><p>Possible choices: builtin, warpctc, gtnctc, cudnnctc</p>
<p>Type of CTC implementation to calculate loss.</p>
<p>Default: “warpctc”</p>
</dd>
<dt><kbd>--mtlalpha</kbd></dt>
<dd><p>Multitask learning coefficient, alpha:                                 alpha*ctc_loss + (1-alpha)*att_loss</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--asr-weight</kbd></dt>
<dd><p>Multitask learning coefficient for ASR task, weight:  asr_weight*(alpha*ctc_loss + (1-alpha)*att_loss) + (1-asr_weight-mt_weight)*st_loss</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--mt-weight</kbd></dt>
<dd><p>Multitask learning coefficient for MT task, weight:                                 mt_weight*mt_loss + (1-mt_weight-asr_weight)*st_loss</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--lsm-weight</kbd></dt>
<dd><p>Label smoothing weight</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--report-cer</kbd></dt>
<dd><p>Compute CER on development set</p>
<p>Default: False</p>
</dd>
<dt><kbd>--report-wer</kbd></dt>
<dd><p>Compute WER on development set</p>
<p>Default: False</p>
</dd>
<dt><kbd>--report-bleu</kbd></dt>
<dd><p>Compute BLEU on development set</p>
<p>Default: True</p>
</dd>
<dt><kbd>--nbest</kbd></dt>
<dd><p>Output N-best hypotheses</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--beam-size</kbd></dt>
<dd><p>Beam size</p>
<p>Default: 4</p>
</dd>
<dt><kbd>--penalty</kbd></dt>
<dd><p>Incertion penalty</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--maxlenratio</kbd></dt>
<dd><dl class="simple">
<dt>Input length ratio to obtain max output length.</dt><dd><p>If maxlenratio=0.0 (default), it uses a end-detect function
to automatically find maximum hypothesis lengths</p>
</dd>
</dl>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--minlenratio</kbd></dt>
<dd><p>Input length ratio to obtain min output length</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--rnnlm</kbd></dt>
<dd><p>RNNLM model file to read</p>
</dd>
<dt><kbd>--rnnlm-conf</kbd></dt>
<dd><p>RNNLM model config file to read</p>
</dd>
<dt><kbd>--lm-weight</kbd></dt>
<dd><p>RNNLM weight.</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--sym-space</kbd></dt>
<dd><p>Space symbol</p>
<p>Default: “&lt;space&gt;”</p>
</dd>
<dt><kbd>--sym-blank</kbd></dt>
<dd><p>Blank symbol</p>
<p>Default: “&lt;blank&gt;”</p>
</dd>
<dt><kbd>--sortagrad</kbd></dt>
<dd><p>How many epochs to use sortagrad for. 0 = deactivated, -1 = all epochs</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-count</kbd></dt>
<dd><p>Possible choices: auto, seq, bin, frame</p>
<p>How to count batch_size. The default (auto) will find how to count by args.</p>
<p>Default: “auto”</p>
</dd>
<dt><kbd>--batch-size, --batch-seqs, -b</kbd></dt>
<dd><p>Maximum seqs in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-bins</kbd></dt>
<dd><p>Maximum bins in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-in</kbd></dt>
<dd><p>Maximum input frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-out</kbd></dt>
<dd><p>Maximum output frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-inout</kbd></dt>
<dd><p>Maximum input+output frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--maxlen-in, --batch-seq-maxlen-in</kbd></dt>
<dd><p>When –batch-count=seq, batch size is reduced if the input sequence length &gt; ML.</p>
<p>Default: 800</p>
</dd>
<dt><kbd>--maxlen-out, --batch-seq-maxlen-out</kbd></dt>
<dd><p>When –batch-count=seq, batch size is reduced if the output sequence length &gt; ML</p>
<p>Default: 150</p>
</dd>
<dt><kbd>--n-iter-processes</kbd></dt>
<dd><p>Number of processes of iterator</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--preprocess-conf</kbd></dt>
<dd><p>The configuration file for the pre-processing</p>
</dd>
<dt><kbd>--opt</kbd></dt>
<dd><p>Possible choices: adadelta, adam, noam</p>
<p>Optimizer</p>
<p>Default: “adadelta”</p>
</dd>
<dt><kbd>--accum-grad</kbd></dt>
<dd><p>Number of gradient accumuration</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--eps</kbd></dt>
<dd><p>Epsilon constant for optimizer</p>
<p>Default: 1e-08</p>
</dd>
<dt><kbd>--eps-decay</kbd></dt>
<dd><p>Decaying ratio of epsilon</p>
<p>Default: 0.01</p>
</dd>
<dt><kbd>--lr</kbd></dt>
<dd><p>Learning rate for optimizer</p>
<p>Default: 0.001</p>
</dd>
<dt><kbd>--lr-decay</kbd></dt>
<dd><p>Decaying ratio of learning rate</p>
<p>Default: 1.0</p>
</dd>
<dt><kbd>--weight-decay</kbd></dt>
<dd><p>Weight decay ratio</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--criterion</kbd></dt>
<dd><p>Possible choices: loss, acc</p>
<p>Criterion to perform epsilon decay</p>
<p>Default: “acc”</p>
</dd>
<dt><kbd>--threshold</kbd></dt>
<dd><p>Threshold to stop iteration</p>
<p>Default: 0.0001</p>
</dd>
<dt><kbd>--epochs, -e</kbd></dt>
<dd><p>Maximum number of epochs</p>
<p>Default: 30</p>
</dd>
<dt><kbd>--early-stop-criterion</kbd></dt>
<dd><p>Value to monitor to trigger an early stopping of the training</p>
<p>Default: “validation/main/acc”</p>
</dd>
<dt><kbd>--patience</kbd></dt>
<dd><p>Number of epochs to wait without improvement before stopping the training</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--grad-clip</kbd></dt>
<dd><p>Gradient norm threshold to clip</p>
<p>Default: 5</p>
</dd>
<dt><kbd>--num-save-attention</kbd></dt>
<dd><p>Number of samples of attention to be saved</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--num-save-ctc</kbd></dt>
<dd><p>Number of samples of CTC probability to be saved</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--grad-noise</kbd></dt>
<dd><p>The flag to switch to use noise injection to gradients during training</p>
<p>Default: False</p>
</dd>
<dt><kbd>--context-residual</kbd></dt>
<dd><p>The flag to switch to use context vector residual in the decoder network</p>
<p>Default: False</p>
</dd>
<dt><kbd>--enc-init</kbd></dt>
<dd><p>Pre-trained ASR model to initialize encoder.</p>
</dd>
<dt><kbd>--enc-init-mods</kbd></dt>
<dd><p>List of encoder modules to initialize, separated by a comma.</p>
<p>Default: enc.enc.</p>
</dd>
<dt><kbd>--dec-init</kbd></dt>
<dd><p>Pre-trained ASR, MT or LM model to initialize decoder.</p>
</dd>
<dt><kbd>--dec-init-mods</kbd></dt>
<dd><p>List of decoder modules to initialize, separated by a comma.</p>
<p>Default: att., dec.</p>
</dd>
<dt><kbd>--multilingual</kbd></dt>
<dd><p>Prepend target language ID to the source sentence.  Both source/target language IDs must be prepend in the pre-processing stage.</p>
<p>Default: False</p>
</dd>
<dt><kbd>--replace-sos</kbd></dt>
<dd><p>Replace &lt;sos&gt; in the decoder with a target language ID                               (the first token in the target sequence)</p>
<p>Default: False</p>
</dd>
<dt><kbd>--stats-file</kbd></dt>
<dd><p>The stats file for the feature normalization</p>
</dd>
<dt><kbd>--apply-uttmvn</kbd></dt>
<dd><p>Apply utterance level mean variance normalization.</p>
<p>Default: True</p>
</dd>
<dt><kbd>--uttmvn-norm-means</kbd></dt>
<dd><p>Default: True</p>
</dd>
<dt><kbd>--uttmvn-norm-vars</kbd></dt>
<dd><p>Default: False</p>
</dd>
<dt><kbd>--fbank-fs</kbd></dt>
<dd><p>The sample frequency used for the mel-fbank creation.</p>
<p>Default: 16000</p>
</dd>
<dt><kbd>--n-mels</kbd></dt>
<dd><p>The number of mel-frequency bins.</p>
<p>Default: 80</p>
</dd>
<dt><kbd>--fbank-fmin</kbd></dt>
<dd><p>Default: 0.0</p>
</dd>
<dt><kbd>--fbank-fmax</kbd></dt>
<dd></dd>
</dl>
</section>
</section>
<section id="st-trans-py">
<span id="id10"></span><h2>st_trans.py<a class="headerlink" href="#st-trans-py" title="Permalink to this headline">¶</a></h2>
<p><p>Translate text from speech using a speech translation model on one CPU or GPU</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">st_trans</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config2</span> <span class="n">CONFIG2</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">config3</span> <span class="n">CONFIG3</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">dtype</span> <span class="p">{</span><span class="n">float16</span><span class="p">,</span><span class="n">float32</span><span class="p">,</span><span class="n">float64</span><span class="p">}]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">chainer</span><span class="p">,</span><span class="n">pytorch</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">batchsize</span> <span class="n">BATCHSIZE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">preprocess</span><span class="o">-</span><span class="n">conf</span> <span class="n">PREPROCESS_CONF</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">api</span> <span class="p">{</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">}]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">trans</span><span class="o">-</span><span class="n">json</span> <span class="n">TRANS_JSON</span><span class="p">]</span> <span class="o">--</span><span class="n">result</span><span class="o">-</span><span class="n">label</span> <span class="n">RESULT_LABEL</span>
                   <span class="o">--</span><span class="n">model</span> <span class="n">MODEL</span> <span class="p">[</span><span class="o">--</span><span class="n">nbest</span> <span class="n">NBEST</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">beam</span><span class="o">-</span><span class="n">size</span> <span class="n">BEAM_SIZE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">penalty</span> <span class="n">PENALTY</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">maxlenratio</span> <span class="n">MAXLENRATIO</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">minlenratio</span> <span class="n">MINLENRATIO</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">tgt</span><span class="o">-</span><span class="n">lang</span> <span class="n">TGT_LANG</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>Config file path</p>
</dd>
<dt><kbd>--config2</kbd></dt>
<dd><p>Second config file path that overwrites the settings in <cite>–config</cite></p>
</dd>
<dt><kbd>--config3</kbd></dt>
<dd><p>Third config file path that overwrites the settings in <cite>–config</cite> and <cite>–config2</cite></p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--dtype</kbd></dt>
<dd><p>Possible choices: float16, float32, float64</p>
<p>Float precision (only available in –api v2)</p>
<p>Default: “float32”</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: chainer, pytorch</p>
<p>Backend library</p>
<p>Default: “chainer”</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>Random seed</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--batchsize</kbd></dt>
<dd><p>Batch size for beam search (0: means no batch processing)</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--preprocess-conf</kbd></dt>
<dd><p>The configuration file for the pre-processing</p>
</dd>
<dt><kbd>--api</kbd></dt>
<dd><p>Possible choices: v1, v2</p>
<p>Beam search APIs v1: Default API. It only supports the ASRInterface.recognize method and DefaultRNNLM. v2: Experimental API. It supports any models that implements ScorerInterface.</p>
<p>Default: “v1”</p>
</dd>
<dt><kbd>--trans-json</kbd></dt>
<dd><p>Filename of translation data (json)</p>
</dd>
<dt><kbd>--result-label</kbd></dt>
<dd><p>Filename of result label data (json)</p>
</dd>
<dt><kbd>--model</kbd></dt>
<dd><p>Model file parameters to read</p>
</dd>
<dt><kbd>--nbest</kbd></dt>
<dd><p>Output N-best hypotheses</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--beam-size</kbd></dt>
<dd><p>Beam size</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--penalty</kbd></dt>
<dd><p>Incertion penalty</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--maxlenratio</kbd></dt>
<dd><dl class="simple">
<dt>Input length ratio to obtain max output length.</dt><dd><p>If maxlenratio=0.0 (default), it uses a end-detect function
to automatically find maximum hypothesis lengths</p>
</dd>
</dl>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--minlenratio</kbd></dt>
<dd><p>Input length ratio to obtain min output length</p>
<p>Default: 0.0</p>
</dd>
<dt><kbd>--tgt-lang</kbd></dt>
<dd><p>target language ID (e.g., &lt;en&gt;, &lt;de&gt;, and &lt;fr&gt; etc.)</p>
<p>Default: False</p>
</dd>
</dl>
</section>
</section>
<section id="tts-decode-py">
<span id="id11"></span><h2>tts_decode.py<a class="headerlink" href="#tts-decode-py" title="Permalink to this headline">¶</a></h2>
<p><p>Synthesize speech from text using a TTS model on one CPU</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">tts_decode</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config2</span> <span class="n">CONFIG2</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">config3</span> <span class="n">CONFIG3</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">chainer</span><span class="p">,</span><span class="n">pytorch</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span> <span class="o">--</span><span class="n">out</span> <span class="n">OUT</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">preprocess</span><span class="o">-</span><span class="n">conf</span> <span class="n">PREPROCESS_CONF</span><span class="p">]</span> <span class="o">--</span><span class="n">json</span> <span class="n">JSON</span> <span class="o">--</span><span class="n">model</span>
                     <span class="n">MODEL</span> <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">conf</span> <span class="n">MODEL_CONF</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">maxlenratio</span> <span class="n">MAXLENRATIO</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">minlenratio</span> <span class="n">MINLENRATIO</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">threshold</span> <span class="n">THRESHOLD</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">att</span><span class="o">-</span><span class="n">constraint</span> <span class="n">USE_ATT_CONSTRAINT</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">backward</span><span class="o">-</span><span class="n">window</span> <span class="n">BACKWARD_WINDOW</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">forward</span><span class="o">-</span><span class="n">window</span> <span class="n">FORWARD_WINDOW</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">fastspeech</span><span class="o">-</span><span class="n">alpha</span> <span class="n">FASTSPEECH_ALPHA</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">durations</span> <span class="n">SAVE_DURATIONS</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">focus</span><span class="o">-</span><span class="n">rates</span> <span class="n">SAVE_FOCUS_RATES</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>config file path</p>
</dd>
<dt><kbd>--config2</kbd></dt>
<dd><p>second config file path that overwrites the settings in <cite>–config</cite>.</p>
</dd>
<dt><kbd>--config3</kbd></dt>
<dd><p>third config file path that overwrites the settings in <cite>–config</cite> and <cite>–config2</cite>.</p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: chainer, pytorch</p>
<p>Backend library</p>
<p>Default: “pytorch”</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>Random seed</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--out</kbd></dt>
<dd><p>Output filename</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--preprocess-conf</kbd></dt>
<dd><p>The configuration file for the pre-processing</p>
</dd>
<dt><kbd>--json</kbd></dt>
<dd><p>Filename of train label data (json)</p>
</dd>
<dt><kbd>--model</kbd></dt>
<dd><p>Model file parameters to read</p>
</dd>
<dt><kbd>--model-conf</kbd></dt>
<dd><p>Model config file</p>
</dd>
<dt><kbd>--maxlenratio</kbd></dt>
<dd><p>Maximum length ratio in decoding</p>
<p>Default: 5</p>
</dd>
<dt><kbd>--minlenratio</kbd></dt>
<dd><p>Minimum length ratio in decoding</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--threshold</kbd></dt>
<dd><p>Threshold value in decoding</p>
<p>Default: 0.5</p>
</dd>
<dt><kbd>--use-att-constraint</kbd></dt>
<dd><p>Whether to use the attention constraint</p>
<p>Default: False</p>
</dd>
<dt><kbd>--backward-window</kbd></dt>
<dd><p>Backward window size in the attention constraint</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--forward-window</kbd></dt>
<dd><p>Forward window size in the attention constraint</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--fastspeech-alpha</kbd></dt>
<dd><p>Alpha to change the speed for FastSpeech</p>
<p>Default: 1.0</p>
</dd>
<dt><kbd>--save-durations</kbd></dt>
<dd><p>Whether to save durations converted from attentions</p>
<p>Default: False</p>
</dd>
<dt><kbd>--save-focus-rates</kbd></dt>
<dd><p>Whether to save focus rates of attentions</p>
<p>Default: False</p>
</dd>
</dl>
</section>
</section>
<section id="tts-train-py">
<span id="id12"></span><h2>tts_train.py<a class="headerlink" href="#tts-train-py" title="Permalink to this headline">¶</a></h2>
<p><p>Train a new text-to-speech (TTS) model on one CPU, one or multiple GPUs</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">tts_train</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config2</span> <span class="n">CONFIG2</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">config3</span> <span class="n">CONFIG3</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">chainer</span><span class="p">,</span><span class="n">pytorch</span><span class="p">}]</span> <span class="o">--</span><span class="n">outdir</span> <span class="n">OUTDIR</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">resume</span> <span class="p">[</span><span class="n">RESUME</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">minibatches</span> <span class="n">MINIBATCHES</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">tensorboard</span><span class="o">-</span><span class="nb">dir</span> <span class="p">[</span><span class="n">TENSORBOARD_DIR</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="nb">eval</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">epochs</span> <span class="n">EVAL_INTERVAL_EPOCHS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">epochs</span> <span class="n">SAVE_INTERVAL_EPOCHS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">report</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">iters</span> <span class="n">REPORT_INTERVAL_ITERS</span><span class="p">]</span>
                    <span class="o">--</span><span class="n">train</span><span class="o">-</span><span class="n">json</span> <span class="n">TRAIN_JSON</span> <span class="o">--</span><span class="n">valid</span><span class="o">-</span><span class="n">json</span> <span class="n">VALID_JSON</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">module</span> <span class="n">MODEL_MODULE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">sortagrad</span> <span class="p">[</span><span class="n">SORTAGRAD</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">sort</span><span class="o">-</span><span class="n">key</span> <span class="p">[{</span><span class="n">shuffle</span><span class="p">,</span><span class="n">output</span><span class="p">,</span><span class="nb">input</span><span class="p">}]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">count</span> <span class="p">{</span><span class="n">auto</span><span class="p">,</span><span class="n">seq</span><span class="p">,</span><span class="nb">bin</span><span class="p">,</span><span class="n">frame</span><span class="p">}]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">size</span> <span class="n">BATCH_SIZE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">bins</span> <span class="n">BATCH_BINS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="ow">in</span> <span class="n">BATCH_FRAMES_IN</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="n">out</span> <span class="n">BATCH_FRAMES_OUT</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="n">inout</span> <span class="n">BATCH_FRAMES_INOUT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">maxlen</span><span class="o">-</span><span class="ow">in</span> <span class="n">ML</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">maxlen</span><span class="o">-</span><span class="n">out</span> <span class="n">ML</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="nb">iter</span><span class="o">-</span><span class="n">processes</span> <span class="n">NUM_ITER_PROCESSES</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">preprocess</span><span class="o">-</span><span class="n">conf</span> <span class="n">PREPROCESS_CONF</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">speaker</span><span class="o">-</span><span class="n">embedding</span> <span class="n">USE_SPEAKER_EMBEDDING</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">second</span><span class="o">-</span><span class="n">target</span> <span class="n">USE_SECOND_TARGET</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">opt</span> <span class="p">{</span><span class="n">adam</span><span class="p">,</span><span class="n">noam</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">accum</span><span class="o">-</span><span class="n">grad</span> <span class="n">ACCUM_GRAD</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lr</span> <span class="n">LR</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">eps</span> <span class="n">EPS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">weight</span><span class="o">-</span><span class="n">decay</span> <span class="n">WEIGHT_DECAY</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">epochs</span> <span class="n">EPOCHS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">early</span><span class="o">-</span><span class="n">stop</span><span class="o">-</span><span class="n">criterion</span> <span class="p">[</span><span class="n">EARLY_STOP_CRITERION</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">patience</span> <span class="p">[</span><span class="n">PATIENCE</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">grad</span><span class="o">-</span><span class="n">clip</span> <span class="n">GRAD_CLIP</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">save</span><span class="o">-</span><span class="n">attention</span> <span class="n">NUM_SAVE_ATTENTION</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">keep</span><span class="o">-</span><span class="nb">all</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">mem</span> <span class="n">KEEP_ALL_DATA_ON_MEM</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">enc</span><span class="o">-</span><span class="n">init</span> <span class="n">ENC_INIT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">enc</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">mods</span> <span class="n">ENC_INIT_MODS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">dec</span><span class="o">-</span><span class="n">init</span> <span class="n">DEC_INIT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">dec</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">mods</span> <span class="n">DEC_INIT_MODS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">freeze</span><span class="o">-</span><span class="n">mods</span> <span class="n">FREEZE_MODS</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>config file path</p>
</dd>
<dt><kbd>--config2</kbd></dt>
<dd><p>second config file path that overwrites the settings in <cite>–config</cite>.</p>
</dd>
<dt><kbd>--config3</kbd></dt>
<dd><p>third config file path that overwrites the settings in <cite>–config</cite> and <cite>–config2</cite>.</p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs. If not given, use all visible devices</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: chainer, pytorch</p>
<p>Backend library</p>
<p>Default: “pytorch”</p>
</dd>
<dt><kbd>--outdir</kbd></dt>
<dd><p>Output directory</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>Random seed</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--resume, -r</kbd></dt>
<dd><p>Resume the training from snapshot</p>
<p>Default: “”</p>
</dd>
<dt><kbd>--minibatches, -N</kbd></dt>
<dd><p>Process only N minibatches (for debug)</p>
<p>Default: -1</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--tensorboard-dir</kbd></dt>
<dd><p>Tensorboard log directory path</p>
</dd>
<dt><kbd>--eval-interval-epochs</kbd></dt>
<dd><p>Evaluation interval epochs</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--save-interval-epochs</kbd></dt>
<dd><p>Save interval epochs</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--report-interval-iters</kbd></dt>
<dd><p>Report interval iterations</p>
<p>Default: 100</p>
</dd>
<dt><kbd>--train-json</kbd></dt>
<dd><p>Filename of training json</p>
</dd>
<dt><kbd>--valid-json</kbd></dt>
<dd><p>Filename of validation json</p>
</dd>
<dt><kbd>--model-module</kbd></dt>
<dd><p>model defined module</p>
<p>Default: “espnet.nets.pytorch_backend.e2e_tts_tacotron2:Tacotron2”</p>
</dd>
<dt><kbd>--sortagrad</kbd></dt>
<dd><p>How many epochs to use sortagrad for. 0 = deactivated, -1 = all epochs</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-sort-key</kbd></dt>
<dd><p>Possible choices: shuffle, output, input</p>
<p>Batch sorting key. “shuffle” only work with –batch-count “seq”.</p>
<p>Default: “shuffle”</p>
</dd>
<dt><kbd>--batch-count</kbd></dt>
<dd><p>Possible choices: auto, seq, bin, frame</p>
<p>How to count batch_size. The default (auto) will find how to count by args.</p>
<p>Default: “auto”</p>
</dd>
<dt><kbd>--batch-size, --batch-seqs, -b</kbd></dt>
<dd><p>Maximum seqs in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-bins</kbd></dt>
<dd><p>Maximum bins in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-in</kbd></dt>
<dd><p>Maximum input frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-out</kbd></dt>
<dd><p>Maximum output frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-inout</kbd></dt>
<dd><p>Maximum input+output frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--maxlen-in, --batch-seq-maxlen-in</kbd></dt>
<dd><p>When –batch-count=seq, batch size is reduced if the input sequence length &gt; ML.</p>
<p>Default: 100</p>
</dd>
<dt><kbd>--maxlen-out, --batch-seq-maxlen-out</kbd></dt>
<dd><p>When –batch-count=seq, batch size is reduced if the output sequence length &gt; ML</p>
<p>Default: 200</p>
</dd>
<dt><kbd>--num-iter-processes</kbd></dt>
<dd><p>Number of processes of iterator</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--preprocess-conf</kbd></dt>
<dd><p>The configuration file for the pre-processing</p>
</dd>
<dt><kbd>--use-speaker-embedding</kbd></dt>
<dd><p>Whether to use speaker embedding</p>
<p>Default: False</p>
</dd>
<dt><kbd>--use-second-target</kbd></dt>
<dd><p>Whether to use second target</p>
<p>Default: False</p>
</dd>
<dt><kbd>--opt</kbd></dt>
<dd><p>Possible choices: adam, noam</p>
<p>Optimizer</p>
<p>Default: “adam”</p>
</dd>
<dt><kbd>--accum-grad</kbd></dt>
<dd><p>Number of gradient accumuration</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--lr</kbd></dt>
<dd><p>Learning rate for optimizer</p>
<p>Default: 0.001</p>
</dd>
<dt><kbd>--eps</kbd></dt>
<dd><p>Epsilon for optimizer</p>
<p>Default: 1e-06</p>
</dd>
<dt><kbd>--weight-decay</kbd></dt>
<dd><p>Weight decay coefficient for optimizer</p>
<p>Default: 1e-06</p>
</dd>
<dt><kbd>--epochs, -e</kbd></dt>
<dd><p>Number of maximum epochs</p>
<p>Default: 30</p>
</dd>
<dt><kbd>--early-stop-criterion</kbd></dt>
<dd><p>Value to monitor to trigger an early stopping of the training</p>
<p>Default: “validation/main/loss”</p>
</dd>
<dt><kbd>--patience</kbd></dt>
<dd><p>Number of epochs to wait without improvement before stopping the training</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--grad-clip</kbd></dt>
<dd><p>Gradient norm threshold to clip</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--num-save-attention</kbd></dt>
<dd><p>Number of samples of attention to be saved</p>
<p>Default: 5</p>
</dd>
<dt><kbd>--keep-all-data-on-mem</kbd></dt>
<dd><p>Whether to keep all data on memory</p>
<p>Default: False</p>
</dd>
<dt><kbd>--enc-init</kbd></dt>
<dd><p>Pre-trained TTS model path to initialize encoder.</p>
</dd>
<dt><kbd>--enc-init-mods</kbd></dt>
<dd><p>List of encoder modules to initialize, separated by a comma.</p>
<p>Default: enc.</p>
</dd>
<dt><kbd>--dec-init</kbd></dt>
<dd><p>Pre-trained TTS model path to initialize decoder.</p>
</dd>
<dt><kbd>--dec-init-mods</kbd></dt>
<dd><p>List of decoder modules to initialize, separated by a comma.</p>
<p>Default: dec.</p>
</dd>
<dt><kbd>--freeze-mods</kbd></dt>
<dd><p>List of modules to freeze (not to train), separated by a comma.</p>
</dd>
</dl>
</section>
</section>
<section id="vc-decode-py">
<span id="id13"></span><h2>vc_decode.py<a class="headerlink" href="#vc-decode-py" title="Permalink to this headline">¶</a></h2>
<p><p>Converting speech using a VC model on one CPU</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">vc_decode</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config2</span> <span class="n">CONFIG2</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">config3</span> <span class="n">CONFIG3</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">chainer</span><span class="p">,</span><span class="n">pytorch</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span> <span class="o">--</span><span class="n">out</span> <span class="n">OUT</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">preprocess</span><span class="o">-</span><span class="n">conf</span> <span class="n">PREPROCESS_CONF</span><span class="p">]</span> <span class="o">--</span><span class="n">json</span> <span class="n">JSON</span> <span class="o">--</span><span class="n">model</span>
                    <span class="n">MODEL</span> <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">conf</span> <span class="n">MODEL_CONF</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">maxlenratio</span> <span class="n">MAXLENRATIO</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">minlenratio</span> <span class="n">MINLENRATIO</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">threshold</span> <span class="n">THRESHOLD</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">att</span><span class="o">-</span><span class="n">constraint</span> <span class="n">USE_ATT_CONSTRAINT</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">backward</span><span class="o">-</span><span class="n">window</span> <span class="n">BACKWARD_WINDOW</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">forward</span><span class="o">-</span><span class="n">window</span> <span class="n">FORWARD_WINDOW</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">durations</span> <span class="n">SAVE_DURATIONS</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">focus</span><span class="o">-</span><span class="n">rates</span> <span class="n">SAVE_FOCUS_RATES</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>config file path</p>
</dd>
<dt><kbd>--config2</kbd></dt>
<dd><p>second config file path that overwrites the settings in <cite>–config</cite>.</p>
</dd>
<dt><kbd>--config3</kbd></dt>
<dd><p>third config file path that overwrites the settings in <cite>–config</cite> and <cite>–config2</cite>.</p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: chainer, pytorch</p>
<p>Backend library</p>
<p>Default: “pytorch”</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>Random seed</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--out</kbd></dt>
<dd><p>Output filename</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--preprocess-conf</kbd></dt>
<dd><p>The configuration file for the pre-processing</p>
</dd>
<dt><kbd>--json</kbd></dt>
<dd><p>Filename of train label data (json)</p>
</dd>
<dt><kbd>--model</kbd></dt>
<dd><p>Model file parameters to read</p>
</dd>
<dt><kbd>--model-conf</kbd></dt>
<dd><p>Model config file</p>
</dd>
<dt><kbd>--maxlenratio</kbd></dt>
<dd><p>Maximum length ratio in decoding</p>
<p>Default: 5</p>
</dd>
<dt><kbd>--minlenratio</kbd></dt>
<dd><p>Minimum length ratio in decoding</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--threshold</kbd></dt>
<dd><p>Threshold value in decoding</p>
<p>Default: 0.5</p>
</dd>
<dt><kbd>--use-att-constraint</kbd></dt>
<dd><p>Whether to use the attention constraint</p>
<p>Default: False</p>
</dd>
<dt><kbd>--backward-window</kbd></dt>
<dd><p>Backward window size in the attention constraint</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--forward-window</kbd></dt>
<dd><p>Forward window size in the attention constraint</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--save-durations</kbd></dt>
<dd><p>Whether to save durations converted from attentions</p>
<p>Default: False</p>
</dd>
<dt><kbd>--save-focus-rates</kbd></dt>
<dd><p>Whether to save focus rates of attentions</p>
<p>Default: False</p>
</dd>
</dl>
</section>
</section>
<section id="vc-train-py">
<span id="id14"></span><h2>vc_train.py<a class="headerlink" href="#vc-train-py" title="Permalink to this headline">¶</a></h2>
<p><p>Train a new voice conversion (VC) model on one CPU, one or multiple GPUs</p>
</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">vc_train</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">config2</span> <span class="n">CONFIG2</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">config3</span> <span class="n">CONFIG3</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ngpu</span> <span class="n">NGPU</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">backend</span> <span class="p">{</span><span class="n">chainer</span><span class="p">,</span><span class="n">pytorch</span><span class="p">}]</span> <span class="o">--</span><span class="n">outdir</span> <span class="n">OUTDIR</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">debugmode</span> <span class="n">DEBUGMODE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">resume</span> <span class="p">[</span><span class="n">RESUME</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">minibatches</span> <span class="n">MINIBATCHES</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="n">VERBOSE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">tensorboard</span><span class="o">-</span><span class="nb">dir</span> <span class="p">[</span><span class="n">TENSORBOARD_DIR</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="nb">eval</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">epochs</span> <span class="n">EVAL_INTERVAL_EPOCHS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">epochs</span> <span class="n">SAVE_INTERVAL_EPOCHS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">report</span><span class="o">-</span><span class="n">interval</span><span class="o">-</span><span class="n">iters</span> <span class="n">REPORT_INTERVAL_ITERS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">srcspk</span> <span class="n">SRCSPK</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">trgspk</span> <span class="n">TRGSPK</span><span class="p">]</span> <span class="o">--</span><span class="n">train</span><span class="o">-</span><span class="n">json</span> <span class="n">TRAIN_JSON</span>
                   <span class="o">--</span><span class="n">valid</span><span class="o">-</span><span class="n">json</span> <span class="n">VALID_JSON</span> <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">module</span> <span class="n">MODEL_MODULE</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">sortagrad</span> <span class="p">[</span><span class="n">SORTAGRAD</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">sort</span><span class="o">-</span><span class="n">key</span> <span class="p">[{</span><span class="n">shuffle</span><span class="p">,</span><span class="n">output</span><span class="p">,</span><span class="nb">input</span><span class="p">}]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">count</span> <span class="p">{</span><span class="n">auto</span><span class="p">,</span><span class="n">seq</span><span class="p">,</span><span class="nb">bin</span><span class="p">,</span><span class="n">frame</span><span class="p">}]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">size</span> <span class="n">BATCH_SIZE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">bins</span> <span class="n">BATCH_BINS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="ow">in</span> <span class="n">BATCH_FRAMES_IN</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="n">out</span> <span class="n">BATCH_FRAMES_OUT</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="n">inout</span> <span class="n">BATCH_FRAMES_INOUT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">maxlen</span><span class="o">-</span><span class="ow">in</span> <span class="n">ML</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">maxlen</span><span class="o">-</span><span class="n">out</span> <span class="n">ML</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="nb">iter</span><span class="o">-</span><span class="n">processes</span> <span class="n">NUM_ITER_PROCESSES</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">preprocess</span><span class="o">-</span><span class="n">conf</span> <span class="n">PREPROCESS_CONF</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">speaker</span><span class="o">-</span><span class="n">embedding</span> <span class="n">USE_SPEAKER_EMBEDDING</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">second</span><span class="o">-</span><span class="n">target</span> <span class="n">USE_SECOND_TARGET</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">opt</span> <span class="p">{</span><span class="n">adam</span><span class="p">,</span><span class="n">noam</span><span class="p">,</span><span class="n">lamb</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">accum</span><span class="o">-</span><span class="n">grad</span> <span class="n">ACCUM_GRAD</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">lr</span> <span class="n">LR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">eps</span> <span class="n">EPS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">weight</span><span class="o">-</span><span class="n">decay</span> <span class="n">WEIGHT_DECAY</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">epochs</span> <span class="n">EPOCHS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">early</span><span class="o">-</span><span class="n">stop</span><span class="o">-</span><span class="n">criterion</span> <span class="p">[</span><span class="n">EARLY_STOP_CRITERION</span><span class="p">]]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">patience</span> <span class="p">[</span><span class="n">PATIENCE</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">grad</span><span class="o">-</span><span class="n">clip</span> <span class="n">GRAD_CLIP</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">save</span><span class="o">-</span><span class="n">attention</span> <span class="n">NUM_SAVE_ATTENTION</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">keep</span><span class="o">-</span><span class="nb">all</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">mem</span> <span class="n">KEEP_ALL_DATA_ON_MEM</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">enc</span><span class="o">-</span><span class="n">init</span> <span class="n">ENC_INIT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">enc</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">mods</span> <span class="n">ENC_INIT_MODS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">dec</span><span class="o">-</span><span class="n">init</span> <span class="n">DEC_INIT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">dec</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">mods</span> <span class="n">DEC_INIT_MODS</span><span class="p">]</span>
                   <span class="p">[</span><span class="o">--</span><span class="n">freeze</span><span class="o">-</span><span class="n">mods</span> <span class="n">FREEZE_MODS</span><span class="p">]</span>
</pre></div>
</div>
<section id="Named Arguments">
<h3>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline">¶</a></h3>
<dl class="option-list">
<dt><kbd>--config</kbd></dt>
<dd><p>config file path</p>
</dd>
<dt><kbd>--config2</kbd></dt>
<dd><p>second config file path that overwrites the settings in <cite>–config</cite>.</p>
</dd>
<dt><kbd>--config3</kbd></dt>
<dd><p>third config file path that overwrites the settings in <cite>–config</cite> and <cite>–config2</cite>.</p>
</dd>
<dt><kbd>--ngpu</kbd></dt>
<dd><p>Number of GPUs. If not given, use all visible devices</p>
</dd>
<dt><kbd>--backend</kbd></dt>
<dd><p>Possible choices: chainer, pytorch</p>
<p>Backend library</p>
<p>Default: “pytorch”</p>
</dd>
<dt><kbd>--outdir</kbd></dt>
<dd><p>Output directory</p>
</dd>
<dt><kbd>--debugmode</kbd></dt>
<dd><p>Debugmode</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>Random seed</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--resume, -r</kbd></dt>
<dd><p>Resume the training from snapshot</p>
<p>Default: “”</p>
</dd>
<dt><kbd>--minibatches, -N</kbd></dt>
<dd><p>Process only N minibatches (for debug)</p>
<p>Default: -1</p>
</dd>
<dt><kbd>--verbose, -V</kbd></dt>
<dd><p>Verbose option</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--tensorboard-dir</kbd></dt>
<dd><p>Tensorboard log directory path</p>
</dd>
<dt><kbd>--eval-interval-epochs</kbd></dt>
<dd><p>Evaluation interval epochs</p>
<p>Default: 100</p>
</dd>
<dt><kbd>--save-interval-epochs</kbd></dt>
<dd><p>Save interval epochs</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--report-interval-iters</kbd></dt>
<dd><p>Report interval iterations</p>
<p>Default: 10</p>
</dd>
<dt><kbd>--srcspk</kbd></dt>
<dd><p>Source speaker</p>
</dd>
<dt><kbd>--trgspk</kbd></dt>
<dd><p>Target speaker</p>
</dd>
<dt><kbd>--train-json</kbd></dt>
<dd><p>Filename of training json</p>
</dd>
<dt><kbd>--valid-json</kbd></dt>
<dd><p>Filename of validation json</p>
</dd>
<dt><kbd>--model-module</kbd></dt>
<dd><p>model defined module</p>
<p>Default: “espnet.nets.pytorch_backend.e2e_tts_tacotron2:Tacotron2”</p>
</dd>
<dt><kbd>--sortagrad</kbd></dt>
<dd><p>How many epochs to use sortagrad for. 0 = deactivated, -1 = all epochs</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-sort-key</kbd></dt>
<dd><p>Possible choices: shuffle, output, input</p>
<p>Batch sorting key. “shuffle” only work with –batch-count “seq”.</p>
<p>Default: “shuffle”</p>
</dd>
<dt><kbd>--batch-count</kbd></dt>
<dd><p>Possible choices: auto, seq, bin, frame</p>
<p>How to count batch_size. The default (auto) will find how to count by args.</p>
<p>Default: “auto”</p>
</dd>
<dt><kbd>--batch-size, --batch-seqs, -b</kbd></dt>
<dd><p>Maximum seqs in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-bins</kbd></dt>
<dd><p>Maximum bins in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-in</kbd></dt>
<dd><p>Maximum input frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-out</kbd></dt>
<dd><p>Maximum output frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--batch-frames-inout</kbd></dt>
<dd><p>Maximum input+output frames in a minibatch (0 to disable)</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--maxlen-in, --batch-seq-maxlen-in</kbd></dt>
<dd><p>When –batch-count=seq, batch size is reduced if the input sequence length &gt; ML.</p>
<p>Default: 100</p>
</dd>
<dt><kbd>--maxlen-out, --batch-seq-maxlen-out</kbd></dt>
<dd><p>When –batch-count=seq, batch size is reduced if the output sequence length &gt; ML</p>
<p>Default: 200</p>
</dd>
<dt><kbd>--num-iter-processes</kbd></dt>
<dd><p>Number of processes of iterator</p>
<p>Default: 0</p>
</dd>
<dt><kbd>--preprocess-conf</kbd></dt>
<dd><p>The configuration file for the pre-processing</p>
</dd>
<dt><kbd>--use-speaker-embedding</kbd></dt>
<dd><p>Whether to use speaker embedding</p>
<p>Default: False</p>
</dd>
<dt><kbd>--use-second-target</kbd></dt>
<dd><p>Whether to use second target</p>
<p>Default: False</p>
</dd>
<dt><kbd>--opt</kbd></dt>
<dd><p>Possible choices: adam, noam, lamb</p>
<p>Optimizer</p>
<p>Default: “adam”</p>
</dd>
<dt><kbd>--accum-grad</kbd></dt>
<dd><p>Number of gradient accumuration</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--lr</kbd></dt>
<dd><p>Learning rate for optimizer</p>
<p>Default: 0.001</p>
</dd>
<dt><kbd>--eps</kbd></dt>
<dd><p>Epsilon for optimizer</p>
<p>Default: 1e-06</p>
</dd>
<dt><kbd>--weight-decay</kbd></dt>
<dd><p>Weight decay coefficient for optimizer</p>
<p>Default: 1e-06</p>
</dd>
<dt><kbd>--epochs, -e</kbd></dt>
<dd><p>Number of maximum epochs</p>
<p>Default: 30</p>
</dd>
<dt><kbd>--early-stop-criterion</kbd></dt>
<dd><p>Value to monitor to trigger an early stopping of the training</p>
<p>Default: “validation/main/loss”</p>
</dd>
<dt><kbd>--patience</kbd></dt>
<dd><p>Number of epochs to wait without improvement before stopping the training</p>
<p>Default: 3</p>
</dd>
<dt><kbd>--grad-clip</kbd></dt>
<dd><p>Gradient norm threshold to clip</p>
<p>Default: 1</p>
</dd>
<dt><kbd>--num-save-attention</kbd></dt>
<dd><p>Number of samples of attention to be saved</p>
<p>Default: 5</p>
</dd>
<dt><kbd>--keep-all-data-on-mem</kbd></dt>
<dd><p>Whether to keep all data on memory</p>
<p>Default: False</p>
</dd>
<dt><kbd>--enc-init</kbd></dt>
<dd><p>Pre-trained model path to initialize encoder.</p>
</dd>
<dt><kbd>--enc-init-mods</kbd></dt>
<dd><p>List of encoder modules to initialize, separated by a comma.</p>
<p>Default: enc.</p>
</dd>
<dt><kbd>--dec-init</kbd></dt>
<dd><p>Pre-trained model path to initialize decoder.</p>
</dd>
<dt><kbd>--dec-init-mods</kbd></dt>
<dd><p>List of decoder modules to initialize, separated by a comma.</p>
<p>Default: dec.</p>
</dd>
<dt><kbd>--freeze-mods</kbd></dt>
<dd><p>List of modules to freeze (not to train), separated by a comma.</p>
</dd>
</dl>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../_gen/espnet2.main_funcs.html" class="btn btn-neutral float-left" title="espnet2.main_funcs package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="espnet2_bin.html" class="btn btn-neutral float-right" title="core tools (espnet2)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Shinji Watanabe.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>