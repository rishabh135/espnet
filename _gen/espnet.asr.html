<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>espnet.asr package &mdash; ESPnet 202205 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="espnet.bin package" href="espnet.bin.html" />
    <link rel="prev" title="espnet.scheduler package" href="espnet.scheduler.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> ESPnet
          </a>
              <div class="version">
                202205
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallelization.html">Using Job scheduling system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">Docker</a></li>
</ul>
<p><span class="caption-text">ESPnet2:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_tutorial.html">ESPnet2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_tutorial.html#instruction-for-run-sh">Instruction for run.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_training_option.html">Change the configuration for training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_task.html">Task class and data input system for training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_distributed.html">Distributed training</a></li>
</ul>
<p><span class="caption-text">Notebook:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebook/asr_cli.html">Speech Recognition (Recipe)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/asr_library.html">Speech Recognition (Library)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_asr_realtime_demo.html">ESPnet2-ASR realtime demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_asr_transfer_learning_demo.html"><strong>Use transfer learning for ASR in ESPnet2</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_asr_transfer_learning_demo.html#Abstract">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_asr_transfer_learning_demo.html#ESPnet-installation-(about-10-minutes-in-total)">ESPnet installation (about 10 minutes in total)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_asr_transfer_learning_demo.html#mini_an4-recipe-as-a-transfer-learning-example">mini_an4 recipe as a transfer learning example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_streaming_asr_demo.html">ESPnet2 real streaming Transformer demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_tts_realtime_demo.html">ESPnet2-TTS realtime demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_tutorial_2021_CMU_11751_18781.html">CMU 11751/18781 2021: ESPnet Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_tutorial_2021_CMU_11751_18781.html#Run-an-inference-example">Run an inference example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_tutorial_2021_CMU_11751_18781.html#Full-installation">Full installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet2_tutorial_2021_CMU_11751_18781.html#Run-a-recipe-example">Run a recipe example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet_se_demonstration_for_waspaa_2021.html">ESPnet Speech Enhancement Demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet_se_demonstration_for_waspaa_2021.html#Contents">Contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet_se_demonstration_for_waspaa_2021.html#(1)-Tutorials-on-the-Basic-Usage">(1) Tutorials on the Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/espnet_se_demonstration_for_waspaa_2021.html#(2)-Tutorials-on-Contributing-to-ESPNet-SE-Project">(2) Tutorials on Contributing to ESPNet-SE Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/pretrained.html">Pretrained Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/se_demo.html">ESPnet Speech Enhancement Demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/st_demo.html">ESPnet Speech Translation Demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/tts_cli.html">Text-to-Speech (Recipe)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/tts_realtime_demo.html">ESPnet real time E2E-TTS demonstration</a></li>
</ul>
<p><span class="caption-text">Package Reference:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="espnet.optimizer.html">espnet.optimizer package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.utils.html">espnet.utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.mt.html">espnet.mt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.nets.html">espnet.nets package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.tts.html">espnet.tts package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.vc.html">espnet.vc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.st.html">espnet.st package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.scheduler.html">espnet.scheduler package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">espnet.asr package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#espnet-asr-asr-mix-utils">espnet.asr.asr_mix_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet-asr-init">espnet.asr.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet-asr-asr-utils">espnet.asr.asr_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet-asr-pytorch-backend-asr-init">espnet.asr.pytorch_backend.asr_init</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet-asr-pytorch-backend-asr">espnet.asr.pytorch_backend.asr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet-asr-pytorch-backend-recog">espnet.asr.pytorch_backend.recog</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet-asr-pytorch-backend-asr-mix">espnet.asr.pytorch_backend.asr_mix</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet-asr-pytorch-backend-init">espnet.asr.pytorch_backend.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet-asr-chainer-backend-asr">espnet.asr.chainer_backend.asr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet-asr-chainer-backend-init">espnet.asr.chainer_backend.__init__</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="espnet.bin.html">espnet.bin package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.lm.html">espnet.lm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.transform.html">espnet.transform package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.fst.html">espnet2.fst package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.schedulers.html">espnet2.schedulers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.samplers.html">espnet2.samplers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.utils.html">espnet2.utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.fileio.html">espnet2.fileio package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.iterators.html">espnet2.iterators package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.mt.html">espnet2.mt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.hubert.html">espnet2.hubert package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.enh.html">espnet2.enh package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.optimizers.html">espnet2.optimizers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.train.html">espnet2.train package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.tts.html">espnet2.tts package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.st.html">espnet2.st package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.text.html">espnet2.text package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.torch_utils.html">espnet2.torch_utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.gan_tts.html">espnet2.gan_tts package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.asr.html">espnet2.asr package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.bin.html">espnet2.bin package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.lm.html">espnet2.lm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.tasks.html">espnet2.tasks package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.diar.html">espnet2.diar package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.layers.html">espnet2.layers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.main_funcs.html">espnet2.main_funcs package</a></li>
</ul>
<p><span class="caption-text">Tool Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apis/espnet_bin.html">core tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apis/espnet2_bin.html">core tools (espnet2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apis/utils_py.html">python utility tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apis/utils_sh.html">bash utility tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ESPnet</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>espnet.asr package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_gen/espnet.asr.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="espnet-asr-package">
<h1>espnet.asr package<a class="headerlink" href="#espnet-asr-package" title="Permalink to this headline">¶</a></h1>
<p>Initialize sub package.</p>
<section id="espnet-asr-asr-mix-utils">
<span id="id1"></span><h2>espnet.asr.asr_mix_utils<a class="headerlink" href="#espnet-asr-asr-mix-utils" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet.asr.asr_mix_utils"></span><p>This script is used to provide utility functions designed for multi-speaker ASR.</p>
<dl class="simple">
<dt>Copyright 2017 Johns Hopkins University (Shinji Watanabe)</dt><dd><p>Apache 2.0  (<a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>)</p>
</dd>
<dt>Most functions can be directly used as in asr_utils.py:</dt><dd><p>CompareValueTrigger, restore_snapshot, adadelta_eps_decay, chainer_load,
torch_snapshot, torch_save, torch_resume, AttributeDict, get_model_conf.</p>
</dd>
</dl>
<dl class="class">
<dt id="espnet.asr.asr_mix_utils.PlotAttentionReport">
<em class="property">class </em><code class="sig-prename descclassname">espnet.asr.asr_mix_utils.</code><code class="sig-name descname">PlotAttentionReport</code><span class="sig-paren">(</span><em class="sig-param">att_vis_fn</em>, <em class="sig-param">data</em>, <em class="sig-param">outdir</em>, <em class="sig-param">converter</em>, <em class="sig-param">device</em>, <em class="sig-param">reverse=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_mix_utils.html#PlotAttentionReport"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_mix_utils.PlotAttentionReport" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">chainer.training.extension.Extension</span></code></p>
<p>Plot attention reporter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>att_vis_fn</strong> (<em>espnet.nets.*_backend.e2e_asr.calculate_all_attentions</em>) – Function of attention visualization.</p></li>
<li><p><strong>data</strong> (<em>list</em><em>[</em><em>tuple</em><em>(</em><em>str</em><em>, </em><em>dict</em><em>[</em><em>str</em><em>, </em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em><em>)</em><em>]</em>) – List json utt key items.</p></li>
<li><p><strong>outdir</strong> (<em>str</em>) – Directory to save figures.</p></li>
<li><p><strong>converter</strong> (<em>espnet.asr.*_backend.asr.CustomConverter</em>) – CustomConverter object. Function to convert data.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – The destination device to send tensor.</p></li>
<li><p><strong>reverse</strong> (<em>bool</em>) – If True, input and output length are reversed.</p></li>
</ul>
</dd>
</dl>
<p>Initialize PlotAttentionReport.</p>
<dl class="method">
<dt id="espnet.asr.asr_mix_utils.PlotAttentionReport.draw_attention_plot">
<code class="sig-name descname">draw_attention_plot</code><span class="sig-paren">(</span><em class="sig-param">att_w</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_mix_utils.html#PlotAttentionReport.draw_attention_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_mix_utils.PlotAttentionReport.draw_attention_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize attention weights matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>att_w</strong> (<em>Tensor</em>) – Attention weight matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pyplot object with attention matrix image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyplot</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet.asr.asr_mix_utils.PlotAttentionReport.get_attention_weight">
<code class="sig-name descname">get_attention_weight</code><span class="sig-paren">(</span><em class="sig-param">idx</em>, <em class="sig-param">att_w</em>, <em class="sig-param">spkr_idx</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_mix_utils.html#PlotAttentionReport.get_attention_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_mix_utils.PlotAttentionReport.get_attention_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform attention weight in regard to self.reverse.</p>
</dd></dl>

<dl class="method">
<dt id="espnet.asr.asr_mix_utils.PlotAttentionReport.get_attention_weights">
<code class="sig-name descname">get_attention_weights</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_mix_utils.html#PlotAttentionReport.get_attention_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_mix_utils.PlotAttentionReport.get_attention_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Return attention weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl>
<dt>attention weights. It’s shape would be</dt><dd><p>differ from bachend.dtype=float
* pytorch-&gt; 1) multi-head case =&gt; (B, H, Lmax, Tmax). 2)</p>
<blockquote>
<div><p>other case =&gt; (B, Lmax, Tmax).</p>
</div></blockquote>
<ul class="simple">
<li><p>chainer-&gt; attention weights (B, Lmax, Tmax).</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>arr_ws_sd (numpy.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet.asr.asr_mix_utils.PlotAttentionReport.log_attentions">
<code class="sig-name descname">log_attentions</code><span class="sig-paren">(</span><em class="sig-param">logger</em>, <em class="sig-param">step</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_mix_utils.html#PlotAttentionReport.log_attentions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_mix_utils.PlotAttentionReport.log_attentions" title="Permalink to this definition">¶</a></dt>
<dd><p>Add image files of attention matrix to tensorboard.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_mix_utils.add_results_to_json">
<code class="sig-prename descclassname">espnet.asr.asr_mix_utils.</code><code class="sig-name descname">add_results_to_json</code><span class="sig-paren">(</span><em class="sig-param">js</em>, <em class="sig-param">nbest_hyps_sd</em>, <em class="sig-param">char_list</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_mix_utils.html#add_results_to_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_mix_utils.add_results_to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Add N-best results to json.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>js</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Groundtruth utterance dict.</p></li>
<li><p><strong>nbest_hyps_sd</strong> (<em>list</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – List of hypothesis for multi_speakers (# Utts x # Spkrs).</p></li>
<li><p><strong>char_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of characters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>N-best results added utterance dict.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="espnet-asr-init">
<span id="id2"></span><h2>espnet.asr.__init__<a class="headerlink" href="#espnet-asr-init" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet.asr.__init__"></span><p>Initialize sub package.</p>
</section>
<section id="espnet-asr-asr-utils">
<span id="id3"></span><h2>espnet.asr.asr_utils<a class="headerlink" href="#espnet-asr-asr-utils" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet.asr.asr_utils"></span><dl class="class">
<dt id="espnet.asr.asr_utils.CompareValueTrigger">
<em class="property">class </em><code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">CompareValueTrigger</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">compare_fn</em>, <em class="sig-param">trigger=(1</em>, <em class="sig-param">'epoch')</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#CompareValueTrigger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.CompareValueTrigger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Trigger invoked when key value getting bigger or lower than before.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – Key of value.</p></li>
<li><p><strong>compare_fn</strong> (<em>(</em><em>float</em><em>, </em><em>float</em><em>) </em><em>-&gt; bool</em>) – Function to compare the values.</p></li>
<li><p><strong>trigger</strong> (<em>tuple</em><em>(</em><em>int</em><em>, </em><em>str</em><em>)</em>) – Trigger that decide the comparison interval.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="espnet.asr.asr_utils.PlotAttentionReport">
<em class="property">class </em><code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">PlotAttentionReport</code><span class="sig-paren">(</span><em class="sig-param">att_vis_fn</em>, <em class="sig-param">data</em>, <em class="sig-param">outdir</em>, <em class="sig-param">converter</em>, <em class="sig-param">transform</em>, <em class="sig-param">device</em>, <em class="sig-param">reverse=False</em>, <em class="sig-param">ikey='input'</em>, <em class="sig-param">iaxis=0</em>, <em class="sig-param">okey='output'</em>, <em class="sig-param">oaxis=0</em>, <em class="sig-param">subsampling_factor=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#PlotAttentionReport"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.PlotAttentionReport" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">chainer.training.extension.Extension</span></code></p>
<p>Plot attention reporter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>att_vis_fn</strong> (<em>espnet.nets.*_backend.e2e_asr.E2E.calculate_all_attentions</em>) – Function of attention visualization.</p></li>
<li><p><strong>data</strong> (<em>list</em><em>[</em><em>tuple</em><em>(</em><em>str</em><em>, </em><em>dict</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>Any</em><em>]</em><em>]</em><em>)</em><em>]</em>) – List json utt key items.</p></li>
<li><p><strong>outdir</strong> (<em>str</em>) – Directory to save figures.</p></li>
<li><p><strong>converter</strong> (<em>espnet.asr.*_backend.asr.CustomConverter</em>) – Function to convert data.</p></li>
<li><p><strong>device</strong> (<em>int | torch.device</em>) – Device.</p></li>
<li><p><strong>reverse</strong> (<em>bool</em>) – If True, input and output length are reversed.</p></li>
<li><p><strong>ikey</strong> (<em>str</em>) – Key to access input
(for ASR/ST ikey=”input”, for MT ikey=”output”.)</p></li>
<li><p><strong>iaxis</strong> (<em>int</em>) – Dimension to access input
(for ASR/ST iaxis=0, for MT iaxis=1.)</p></li>
<li><p><strong>okey</strong> (<em>str</em>) – Key to access output
(for ASR/ST okey=”input”, MT okay=”output”.)</p></li>
<li><p><strong>oaxis</strong> (<em>int</em>) – Dimension to access output
(for ASR/ST oaxis=0, for MT oaxis=0.)</p></li>
<li><p><strong>subsampling_factor</strong> (<em>int</em>) – subsampling factor in encoder</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet.asr.asr_utils.PlotAttentionReport.draw_attention_plot">
<code class="sig-name descname">draw_attention_plot</code><span class="sig-paren">(</span><em class="sig-param">att_w</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#PlotAttentionReport.draw_attention_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.PlotAttentionReport.draw_attention_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the att_w matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>pyplot object with attention matrix image.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>matplotlib.pyplot</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet.asr.asr_utils.PlotAttentionReport.draw_han_plot">
<code class="sig-name descname">draw_han_plot</code><span class="sig-paren">(</span><em class="sig-param">att_w</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#PlotAttentionReport.draw_han_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.PlotAttentionReport.draw_han_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the att_w matrix for hierarchical attention.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>pyplot object with attention matrix image.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>matplotlib.pyplot</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet.asr.asr_utils.PlotAttentionReport.get_attention_weights">
<code class="sig-name descname">get_attention_weights</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#PlotAttentionReport.get_attention_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.PlotAttentionReport.get_attention_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Return attention weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl>
<dt>attention weights. float. Its shape would be</dt><dd><p>differ from backend.
* pytorch-&gt; 1) multi-head case =&gt; (B, H, Lmax, Tmax), 2)</p>
<blockquote>
<div><p>other case =&gt; (B, Lmax, Tmax).</p>
</div></blockquote>
<ul class="simple">
<li><p>chainer-&gt; (B, Lmax, Tmax)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet.asr.asr_utils.PlotAttentionReport.log_attentions">
<code class="sig-name descname">log_attentions</code><span class="sig-paren">(</span><em class="sig-param">logger</em>, <em class="sig-param">step</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#PlotAttentionReport.log_attentions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.PlotAttentionReport.log_attentions" title="Permalink to this definition">¶</a></dt>
<dd><p>Add image files of att_ws matrix to the tensorboard.</p>
</dd></dl>

<dl class="method">
<dt id="espnet.asr.asr_utils.PlotAttentionReport.trim_attention_weight">
<code class="sig-name descname">trim_attention_weight</code><span class="sig-paren">(</span><em class="sig-param">uttid</em>, <em class="sig-param">att_w</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#PlotAttentionReport.trim_attention_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.PlotAttentionReport.trim_attention_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform attention matrix with regard to self.reverse.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet.asr.asr_utils.PlotCTCReport">
<em class="property">class </em><code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">PlotCTCReport</code><span class="sig-paren">(</span><em class="sig-param">ctc_vis_fn</em>, <em class="sig-param">data</em>, <em class="sig-param">outdir</em>, <em class="sig-param">converter</em>, <em class="sig-param">transform</em>, <em class="sig-param">device</em>, <em class="sig-param">reverse=False</em>, <em class="sig-param">ikey='input'</em>, <em class="sig-param">iaxis=0</em>, <em class="sig-param">okey='output'</em>, <em class="sig-param">oaxis=0</em>, <em class="sig-param">subsampling_factor=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#PlotCTCReport"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.PlotCTCReport" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">chainer.training.extension.Extension</span></code></p>
<p>Plot CTC reporter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctc_vis_fn</strong> (<em>espnet.nets.*_backend.e2e_asr.E2E.calculate_all_ctc_probs</em>) – Function of CTC visualization.</p></li>
<li><p><strong>data</strong> (<em>list</em><em>[</em><em>tuple</em><em>(</em><em>str</em><em>, </em><em>dict</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>Any</em><em>]</em><em>]</em><em>)</em><em>]</em>) – List json utt key items.</p></li>
<li><p><strong>outdir</strong> (<em>str</em>) – Directory to save figures.</p></li>
<li><p><strong>converter</strong> (<em>espnet.asr.*_backend.asr.CustomConverter</em>) – Function to convert data.</p></li>
<li><p><strong>device</strong> (<em>int | torch.device</em>) – Device.</p></li>
<li><p><strong>reverse</strong> (<em>bool</em>) – If True, input and output length are reversed.</p></li>
<li><p><strong>ikey</strong> (<em>str</em>) – Key to access input
(for ASR/ST ikey=”input”, for MT ikey=”output”.)</p></li>
<li><p><strong>iaxis</strong> (<em>int</em>) – Dimension to access input
(for ASR/ST iaxis=0, for MT iaxis=1.)</p></li>
<li><p><strong>okey</strong> (<em>str</em>) – Key to access output
(for ASR/ST okey=”input”, MT okay=”output”.)</p></li>
<li><p><strong>oaxis</strong> (<em>int</em>) – Dimension to access output
(for ASR/ST oaxis=0, for MT oaxis=0.)</p></li>
<li><p><strong>subsampling_factor</strong> (<em>int</em>) – subsampling factor in encoder</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet.asr.asr_utils.PlotCTCReport.draw_ctc_plot">
<code class="sig-name descname">draw_ctc_plot</code><span class="sig-paren">(</span><em class="sig-param">ctc_prob</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#PlotCTCReport.draw_ctc_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.PlotCTCReport.draw_ctc_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the ctc_prob matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>pyplot object with CTC prob matrix image.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>matplotlib.pyplot</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet.asr.asr_utils.PlotCTCReport.get_ctc_probs">
<code class="sig-name descname">get_ctc_probs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#PlotCTCReport.get_ctc_probs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.PlotCTCReport.get_ctc_probs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return CTC probs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>CTC probs. float. Its shape would be</dt><dd><p>differ from backend. (B, Tmax, vocab).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet.asr.asr_utils.PlotCTCReport.log_ctc_probs">
<code class="sig-name descname">log_ctc_probs</code><span class="sig-paren">(</span><em class="sig-param">logger</em>, <em class="sig-param">step</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#PlotCTCReport.log_ctc_probs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.PlotCTCReport.log_ctc_probs" title="Permalink to this definition">¶</a></dt>
<dd><p>Add image files of ctc probs to the tensorboard.</p>
</dd></dl>

<dl class="method">
<dt id="espnet.asr.asr_utils.PlotCTCReport.trim_ctc_prob">
<code class="sig-name descname">trim_ctc_prob</code><span class="sig-paren">(</span><em class="sig-param">uttid</em>, <em class="sig-param">prob</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#PlotCTCReport.trim_ctc_prob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.PlotCTCReport.trim_ctc_prob" title="Permalink to this definition">¶</a></dt>
<dd><p>Trim CTC posteriors accoding to input lengths.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.adadelta_eps_decay">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">adadelta_eps_decay</code><span class="sig-paren">(</span><em class="sig-param">eps_decay</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#adadelta_eps_decay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.adadelta_eps_decay" title="Permalink to this definition">¶</a></dt>
<dd><p>Extension to perform adadelta eps decay.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eps_decay</strong> (<em>float</em>) – Decay rate of eps.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An extension function.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.adam_lr_decay">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">adam_lr_decay</code><span class="sig-paren">(</span><em class="sig-param">eps_decay</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#adam_lr_decay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.adam_lr_decay" title="Permalink to this definition">¶</a></dt>
<dd><p>Extension to perform adam lr decay.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eps_decay</strong> (<em>float</em>) – Decay rate of lr.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An extension function.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.add_gradient_noise">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">add_gradient_noise</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">iteration</em>, <em class="sig-param">duration=100</em>, <em class="sig-param">eta=1.0</em>, <em class="sig-param">scale_factor=0.55</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#add_gradient_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.add_gradient_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds noise from a standard normal distribution to the gradients.</p>
<p>The standard deviation (<cite>sigma</cite>) is controlled by the three hyper-parameters below.
<cite>sigma</cite> goes to zero (no noise) with more iterations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.model</em>) – Model.</p></li>
<li><p><strong>iteration</strong> (<em>int</em>) – Number of iterations.</p></li>
<li><p><strong>duration</strong> (<em>int</em>) – Number of durations to control the interval of the <cite>sigma</cite> change.</p></li>
<li><p><strong>eta</strong> (<em>float</em>) – The magnitude of <cite>sigma</cite>.</p></li>
<li><p><strong>scale_factor</strong> (<em>float</em>) – The scale of <cite>sigma</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.add_results_to_json">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">add_results_to_json</code><span class="sig-paren">(</span><em class="sig-param">js</em>, <em class="sig-param">nbest_hyps</em>, <em class="sig-param">char_list</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#add_results_to_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.add_results_to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Add N-best results to json.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>js</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Groundtruth utterance dict.</p></li>
<li><p><strong>nbest_hyps_sd</strong> (<em>list</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – List of hypothesis for multi_speakers: nutts x nspkrs.</p></li>
<li><p><strong>char_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of characters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>N-best results added utterance dict.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.chainer_load">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">chainer_load</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">model</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#chainer_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.chainer_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load chainer model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – Model path or snapshot file path to be loaded.</p></li>
<li><p><strong>model</strong> (<em>chainer.Chain</em>) – Chainer model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.format_mulenc_args">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">format_mulenc_args</code><span class="sig-paren">(</span><em class="sig-param">args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#format_mulenc_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.format_mulenc_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Format args for multi-encoder setup.</p>
<p>It deals with following situations:  (when args.num_encs=2):
1. args.elayers = None -&gt; args.elayers = [4, 4];
2. args.elayers = 4 -&gt; args.elayers = [4, 4];
3. args.elayers = [4, 4, 4] -&gt; args.elayers = [4, 4].</p>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.get_model_conf">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">get_model_conf</code><span class="sig-paren">(</span><em class="sig-param">model_path</em>, <em class="sig-param">conf_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#get_model_conf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.get_model_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>Get model config information by reading a model config file (model.json).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> (<em>str</em>) – Model path.</p></li>
<li><p><strong>conf_path</strong> (<em>str</em>) – Optional model config path.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Config information loaded from json file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list[int, int, dict[str, Any]]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.parse_hypothesis">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">parse_hypothesis</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">char_list</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#parse_hypothesis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.parse_hypothesis" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse hypothesis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> (<em>list</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Recognition hypothesis.</p></li>
<li><p><strong>char_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of characters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(str, str, str, float)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.plot_spectrogram">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">plot_spectrogram</code><span class="sig-paren">(</span><em class="sig-param">plt</em>, <em class="sig-param">spec</em>, <em class="sig-param">mode='db'</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">frame_shift=None</em>, <em class="sig-param">bottom=True</em>, <em class="sig-param">left=True</em>, <em class="sig-param">right=True</em>, <em class="sig-param">top=False</em>, <em class="sig-param">labelbottom=True</em>, <em class="sig-param">labelleft=True</em>, <em class="sig-param">labelright=True</em>, <em class="sig-param">labeltop=False</em>, <em class="sig-param">cmap='inferno'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#plot_spectrogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.plot_spectrogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot spectrogram using matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plt</strong> (<em>matplotlib.pyplot</em>) – pyplot object.</p></li>
<li><p><strong>spec</strong> (<em>numpy.ndarray</em>) – Input stft (Freq, Time)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – db or linear.</p></li>
<li><p><strong>fs</strong> (<em>int</em>) – Sample frequency. To convert y-axis to kHz unit.</p></li>
<li><p><strong>frame_shift</strong> (<em>int</em>) – The frame shift of stft. To convert x-axis to second unit.</p></li>
<li><p><strong>bottom</strong> (<em>bool</em>) – Whether to draw the respective ticks.</p></li>
<li><p><strong>left</strong> (<em>bool</em>) – </p></li>
<li><p><strong>right</strong> (<em>bool</em>) – </p></li>
<li><p><strong>top</strong> (<em>bool</em>) – </p></li>
<li><p><strong>labelbottom</strong> (<em>bool</em>) – Whether to draw the respective tick labels.</p></li>
<li><p><strong>labelleft</strong> (<em>bool</em>) – </p></li>
<li><p><strong>labelright</strong> (<em>bool</em>) – </p></li>
<li><p><strong>labeltop</strong> (<em>bool</em>) – </p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – Colormap defined in matplotlib.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.restore_snapshot">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">restore_snapshot</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">snapshot</em>, <em class="sig-param">load_fn=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#restore_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.restore_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Extension to restore snapshot.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An extension function.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.snapshot_object">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">snapshot_object</code><span class="sig-paren">(</span><em class="sig-param">target</em>, <em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#snapshot_object"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.snapshot_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a trainer extension to take snapshots of a given object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>model</em>) – Object to serialize.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the file into which the object is serialized.It can
be a format string, where the trainer object is passed to
the :meth: <cite>str.format</cite> method. For example,
<code class="docutils literal notranslate"><span class="pre">'snapshot_{.updater.iteration}'</span></code> is converted to
<code class="docutils literal notranslate"><span class="pre">'snapshot_10000'</span></code> at the 10,000th iteration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An extension function.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.torch_load">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">torch_load</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">model</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#torch_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.torch_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load torch model states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – Model path or snapshot file path to be loaded.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Torch model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.torch_resume">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">torch_resume</code><span class="sig-paren">(</span><em class="sig-param">snapshot_path</em>, <em class="sig-param">trainer</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#torch_resume"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.torch_resume" title="Permalink to this definition">¶</a></dt>
<dd><p>Resume from snapshot for pytorch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_path</strong> (<em>str</em>) – Snapshot file path.</p></li>
<li><p><strong>trainer</strong> (<em>chainer.training.Trainer</em>) – Chainer’s trainer instance.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.torch_save">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">torch_save</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">model</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#torch_save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.torch_save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save torch model states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – Model path to be saved.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Torch model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.asr_utils.torch_snapshot">
<code class="sig-prename descclassname">espnet.asr.asr_utils.</code><code class="sig-name descname">torch_snapshot</code><span class="sig-paren">(</span><em class="sig-param">savefun=&lt;function save&gt;</em>, <em class="sig-param">filename='snapshot.ep.{.updater.epoch}'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/asr_utils.html#torch_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.asr_utils.torch_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Extension to take snapshot of the trainer for pytorch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An extension function.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="espnet-asr-pytorch-backend-asr-init">
<span id="id4"></span><h2>espnet.asr.pytorch_backend.asr_init<a class="headerlink" href="#espnet-asr-pytorch-backend-asr-init" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet.asr.pytorch_backend.asr_init"></span><p>Finetuning methods.</p>
<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr_init.create_transducer_compatible_state_dict">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr_init.</code><code class="sig-name descname">create_transducer_compatible_state_dict</code><span class="sig-paren">(</span><em class="sig-param">model_state_dict</em>, <em class="sig-param">encoder_type</em>, <em class="sig-param">encoder_units</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr_init.html#create_transducer_compatible_state_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr_init.create_transducer_compatible_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a compatible transducer model state dict for transfer learning.</p>
<p>If RNN encoder modules from a non-Transducer model are found in
the pre-trained model state dict, the corresponding modules keys are
renamed for compatibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_state_dict</strong> (<em>Dict</em>) – Pre-trained model state dict</p></li>
<li><p><strong>encoder_type</strong> (<em>str</em>) – Type of pre-trained encoder.</p></li>
<li><p><strong>encoder_units</strong> (<em>int</em>) – Number of encoder units in pre-trained model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Transducer compatible pre-trained model state dict.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>new_state_dict (Dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr_init.filter_modules">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr_init.</code><code class="sig-name descname">filter_modules</code><span class="sig-paren">(</span><em class="sig-param">model_state_dict</em>, <em class="sig-param">modules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr_init.html#filter_modules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr_init.filter_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter non-matched modules in model state dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_state_dict</strong> (<em>Dict</em>) – Pre-trained model state dict.</p></li>
<li><p><strong>modules</strong> (<em>List</em>) – Specified module(s) to transfer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Filtered module list.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>new_mods (List)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr_init.freeze_modules">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr_init.</code><code class="sig-name descname">freeze_modules</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">modules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr_init.html#freeze_modules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr_init.freeze_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Freeze model parameters according to modules list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Main model.</p></li>
<li><p><strong>modules</strong> (<em>List</em>) – Specified module(s) to freeze.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Updated main model.
model_params (filter): Filtered model parameters.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model (torch.nn.Module)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr_init.get_lm_state_dict">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr_init.</code><code class="sig-name descname">get_lm_state_dict</code><span class="sig-paren">(</span><em class="sig-param">lm_state_dict</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr_init.html#get_lm_state_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr_init.get_lm_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Create compatible ASR decoder state dict from LM state dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>lm_state_dict</strong> (<em>Dict</em>) – Pre-trained LM state dict.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State dict with compatible key names.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>new_state_dict (Dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr_init.get_partial_state_dict">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr_init.</code><code class="sig-name descname">get_partial_state_dict</code><span class="sig-paren">(</span><em class="sig-param">model_state_dict</em>, <em class="sig-param">modules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr_init.html#get_partial_state_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr_init.get_partial_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Create state dict with specified modules matching input model modules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_state_dict</strong> (<em>Dict</em>) – Pre-trained model state dict.</p></li>
<li><p><strong>modules</strong> (<em>Dict</em>) – Specified module(s) to transfer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State dict with specified modules weights.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>new_state_dict (Dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr_init.get_trained_model_state_dict">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr_init.</code><code class="sig-name descname">get_trained_model_state_dict</code><span class="sig-paren">(</span><em class="sig-param">model_path</em>, <em class="sig-param">new_is_transducer</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr_init.html#get_trained_model_state_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr_init.get_trained_model_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the trained model state dict for pre-initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> (<em>str</em>) – Path to trained model.</p></li>
<li><p><strong>new_is_transducer</strong> (<em>bool</em>) – Whether the new model is Transducer-based.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Trained model state dict.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(Dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr_init.load_trained_model">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr_init.</code><code class="sig-name descname">load_trained_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em>, <em class="sig-param">training=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr_init.html#load_trained_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr_init.load_trained_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the trained model for recognition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> (<em>str</em>) – Path to model.***.best</p></li>
<li><p><strong>training</strong> (<em>bool</em>) – Training mode specification for transducer model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Trained model.
train_args (Namespace): Trained model arguments.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model (torch.nn.Module)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr_init.load_trained_modules">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr_init.</code><code class="sig-name descname">load_trained_modules</code><span class="sig-paren">(</span><em class="sig-param">idim</em>, <em class="sig-param">odim</em>, <em class="sig-param">args</em>, <em class="sig-param">interface=&lt;class 'espnet.nets.asr_interface.ASRInterface'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr_init.html#load_trained_modules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr_init.load_trained_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Load ASR/MT/TTS model with pre-trained weights for specified modules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idim</strong> (<em>int</em>) – Input dimension.</p></li>
<li><p><strong>odim</strong> (<em>int</em>) – Output dimension.</p></li>
<li><p><strong>Namespace</strong> (<em>args</em>) – Model arguments.</p></li>
<li><p><strong>interface</strong> (<em>ASRInterface|MTInterface|TTSInterface</em>) – Model interface.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Model with pre-initialized weights.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>main_model (torch.nn.Module)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr_init.transfer_verification">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr_init.</code><code class="sig-name descname">transfer_verification</code><span class="sig-paren">(</span><em class="sig-param">model_state_dict</em>, <em class="sig-param">partial_state_dict</em>, <em class="sig-param">modules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr_init.html#transfer_verification"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr_init.transfer_verification" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify tuples (key, shape) for input model modules match specified modules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_state_dict</strong> (<em>Dict</em>) – Main model state dict.</p></li>
<li><p><strong>partial_state_dict</strong> (<em>Dict</em>) – Pre-trained model state dict.</p></li>
<li><p><strong>modules</strong> (<em>List</em>) – Specified module(s) to transfer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether transfer learning is allowed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(bool)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="espnet-asr-pytorch-backend-asr">
<span id="id5"></span><h2>espnet.asr.pytorch_backend.asr<a class="headerlink" href="#espnet-asr-pytorch-backend-asr" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet.asr.pytorch_backend.asr"></span><p>Training/decoding definition for the speech recognition task.</p>
<dl class="class">
<dt id="espnet.asr.pytorch_backend.asr.CustomConverter">
<em class="property">class </em><code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr.</code><code class="sig-name descname">CustomConverter</code><span class="sig-paren">(</span><em class="sig-param">subsampling_factor=1</em>, <em class="sig-param">dtype=torch.float32</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr.html#CustomConverter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr.CustomConverter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Custom batch converter for Pytorch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subsampling_factor</strong> (<em>int</em>) – The subsampling factor.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – Data type to convert.</p></li>
</ul>
</dd>
</dl>
<p>Construct a CustomConverter object.</p>
</dd></dl>

<dl class="class">
<dt id="espnet.asr.pytorch_backend.asr.CustomConverterMulEnc">
<em class="property">class </em><code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr.</code><code class="sig-name descname">CustomConverterMulEnc</code><span class="sig-paren">(</span><em class="sig-param">subsampling_factors=[1, 1], dtype=torch.float32</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr.html#CustomConverterMulEnc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr.CustomConverterMulEnc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Custom batch converter for Pytorch in multi-encoder case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subsampling_factors</strong> (<em>list</em>) – List of subsampling factors for each encoder.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – Data type to convert.</p></li>
</ul>
</dd>
</dl>
<p>Initialize the converter.</p>
</dd></dl>

<dl class="class">
<dt id="espnet.asr.pytorch_backend.asr.CustomEvaluator">
<em class="property">class </em><code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr.</code><code class="sig-name descname">CustomEvaluator</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">iterator</em>, <em class="sig-param">target</em>, <em class="sig-param">device</em>, <em class="sig-param">ngpu=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr.html#CustomEvaluator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr.CustomEvaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="espnet.utils.html#espnet.utils.training.evaluator.BaseEvaluator" title="espnet.utils.training.evaluator.BaseEvaluator"><code class="xref py py-class docutils literal notranslate"><span class="pre">espnet.utils.training.evaluator.BaseEvaluator</span></code></a></p>
<p>Custom Evaluator for Pytorch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The model to evaluate.</p></li>
<li><p><strong>iterator</strong> (<em>chainer.dataset.Iterator</em>) – The train iterator.</p></li>
<li><p><strong>target</strong> (<em>link | dict</em><em>[</em><em>str</em><em>, </em><em>link</em><em>]</em>) – Link object or a dictionary of
links to evaluate. If this is just a link object, the link is
registered by the name <code class="docutils literal notranslate"><span class="pre">'main'</span></code>.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – The device used.</p></li>
<li><p><strong>ngpu</strong> (<em>int</em>) – The number of GPUs.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet.asr.pytorch_backend.asr.CustomEvaluator.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr.html#CustomEvaluator.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr.CustomEvaluator.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Main evaluate routine for CustomEvaluator.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet.asr.pytorch_backend.asr.CustomUpdater">
<em class="property">class </em><code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr.</code><code class="sig-name descname">CustomUpdater</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">grad_clip_threshold</em>, <em class="sig-param">train_iter</em>, <em class="sig-param">optimizer</em>, <em class="sig-param">device</em>, <em class="sig-param">ngpu</em>, <em class="sig-param">grad_noise=False</em>, <em class="sig-param">accum_grad=1</em>, <em class="sig-param">use_apex=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr.html#CustomUpdater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr.CustomUpdater" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">chainer.training.updaters.standard_updater.StandardUpdater</span></code></p>
<p>Custom Updater for Pytorch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The model to update.</p></li>
<li><p><strong>grad_clip_threshold</strong> (<em>float</em>) – The gradient clipping value to use.</p></li>
<li><p><strong>train_iter</strong> (<em>chainer.dataset.Iterator</em>) – The training iterator.</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim.optimizer</em>) – The training optimizer.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – The device to use.</p></li>
<li><p><strong>ngpu</strong> (<em>int</em>) – The number of gpus to use.</p></li>
<li><p><strong>use_apex</strong> (<em>bool</em>) – The flag to use Apex in backprop.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet.asr.pytorch_backend.asr.CustomUpdater.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr.html#CustomUpdater.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr.CustomUpdater.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the parameters of the target model.</p>
<p>This method implements an update formula for the training task,
including data loading, forward/backward computations, and actual
updates of parameters.</p>
<p>This method is called once at each iteration of the training loop.</p>
</dd></dl>

<dl class="method">
<dt id="espnet.asr.pytorch_backend.asr.CustomUpdater.update_core">
<code class="sig-name descname">update_core</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr.html#CustomUpdater.update_core"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr.CustomUpdater.update_core" title="Permalink to this definition">¶</a></dt>
<dd><p>Main update routine of the CustomUpdater.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr.enhance">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr.</code><code class="sig-name descname">enhance</code><span class="sig-paren">(</span><em class="sig-param">args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr.html#enhance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr.enhance" title="Permalink to this definition">¶</a></dt>
<dd><p>Dumping enhanced speech and mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>namespace</em>) – The program arguments.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr.recog">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr.</code><code class="sig-name descname">recog</code><span class="sig-paren">(</span><em class="sig-param">args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr.html#recog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr.recog" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode with the given args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>namespace</em>) – The program arguments.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr.train">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr.</code><code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr.html#train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train with the given args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>namespace</em>) – The program arguments.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="espnet-asr-pytorch-backend-recog">
<span id="id6"></span><h2>espnet.asr.pytorch_backend.recog<a class="headerlink" href="#espnet-asr-pytorch-backend-recog" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet.asr.pytorch_backend.recog"></span><p>V2 backend for <cite>asr_recog.py</cite> using py:class:<cite>espnet.nets.beam_search.BeamSearch</cite>.</p>
<dl class="function">
<dt id="espnet.asr.pytorch_backend.recog.recog_v2">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.recog.</code><code class="sig-name descname">recog_v2</code><span class="sig-paren">(</span><em class="sig-param">args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/recog.html#recog_v2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.recog.recog_v2" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode with custom models that implements ScorerInterface.</p>
<p class="rubric">Notes</p>
<p>The previous backend espnet.asr.pytorch_backend.asr.recog
only supports E2E and RNNLM</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>namespace</em>) – The program arguments.</p>
</dd>
</dl>
<p>:param See py:func:<cite>espnet.bin.asr_recog.get_parser</cite> for details:</p>
</dd></dl>

</section>
<section id="espnet-asr-pytorch-backend-asr-mix">
<span id="id7"></span><h2>espnet.asr.pytorch_backend.asr_mix<a class="headerlink" href="#espnet-asr-pytorch-backend-asr-mix" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet.asr.pytorch_backend.asr_mix"></span><p>This script is used for multi-speaker speech recognition.</p>
<dl class="simple">
<dt>Copyright 2017 Johns Hopkins University (Shinji Watanabe)</dt><dd><p>Apache 2.0  (<a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>)</p>
</dd>
</dl>
<dl class="class">
<dt id="espnet.asr.pytorch_backend.asr_mix.CustomConverter">
<em class="property">class </em><code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr_mix.</code><code class="sig-name descname">CustomConverter</code><span class="sig-paren">(</span><em class="sig-param">subsampling_factor=1</em>, <em class="sig-param">dtype=torch.float32</em>, <em class="sig-param">num_spkrs=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr_mix.html#CustomConverter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr_mix.CustomConverter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Custom batch converter for Pytorch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subsampling_factor</strong> (<em>int</em>) – The subsampling factor.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – Data type to convert.</p></li>
</ul>
</dd>
</dl>
<p>Initialize the converter.</p>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr_mix.recog">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr_mix.</code><code class="sig-name descname">recog</code><span class="sig-paren">(</span><em class="sig-param">args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr_mix.html#recog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr_mix.recog" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode with the given args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>namespace</em>) – The program arguments.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.pytorch_backend.asr_mix.train">
<code class="sig-prename descclassname">espnet.asr.pytorch_backend.asr_mix.</code><code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/pytorch_backend/asr_mix.html#train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.pytorch_backend.asr_mix.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train with the given args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>namespace</em>) – The program arguments.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="espnet-asr-pytorch-backend-init">
<span id="id8"></span><h2>espnet.asr.pytorch_backend.__init__<a class="headerlink" href="#espnet-asr-pytorch-backend-init" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet.asr.pytorch_backend.__init__"></span><p>Initialize sub package.</p>
</section>
<section id="espnet-asr-chainer-backend-asr">
<span id="id9"></span><h2>espnet.asr.chainer_backend.asr<a class="headerlink" href="#espnet-asr-chainer-backend-asr" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet.asr.chainer_backend.asr"></span><p>Training/decoding definition for the speech recognition task.</p>
<dl class="function">
<dt id="espnet.asr.chainer_backend.asr.recog">
<code class="sig-prename descclassname">espnet.asr.chainer_backend.asr.</code><code class="sig-name descname">recog</code><span class="sig-paren">(</span><em class="sig-param">args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/chainer_backend/asr.html#recog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.chainer_backend.asr.recog" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode with the given args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>namespace</em>) – The program arguments.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="espnet.asr.chainer_backend.asr.train">
<code class="sig-prename descclassname">espnet.asr.chainer_backend.asr.</code><code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet/asr/chainer_backend/asr.html#train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet.asr.chainer_backend.asr.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train with the given args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>namespace</em>) – The program arguments.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="espnet-asr-chainer-backend-init">
<span id="id10"></span><h2>espnet.asr.chainer_backend.__init__<a class="headerlink" href="#espnet-asr-chainer-backend-init" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet.asr.chainer_backend.__init__"></span><p>Initialize sub package.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="espnet.scheduler.html" class="btn btn-neutral float-left" title="espnet.scheduler package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="espnet.bin.html" class="btn btn-neutral float-right" title="espnet.bin package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Shinji Watanabe.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>